<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Sina Rüeger</title>
    <link>https://sinarueeger.github.io/</link>
    <description>Recent content on Sina Rüeger</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2019. All rights reserved.</copyright>
    <lastBuildDate>Thu, 18 Jul 2019 00:00:00 +0000</lastBuildDate>
    
	    <atom:link href="https://sinarueeger.github.io/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Amuse-bouches from useR!2019</title>
      <link>https://sinarueeger.github.io/post/amuse-bouches-from-user-2019/</link>
      <pubDate>Thu, 18 Jul 2019 00:00:00 +0000</pubDate>
      
      <guid>https://sinarueeger.github.io/post/amuse-bouches-from-user-2019/</guid>
      <description>


&lt;p&gt;The 3+ days at &lt;a href=&#34;http://www.user2019.fr&#34;&gt;useR!2019 in Toulouse&lt;/a&gt; were packed with great talks&lt;a href=&#34;#fn1&#34; class=&#34;footnote-ref&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; and good food - hence the &lt;a href=&#34;https://en.wikipedia.org/wiki/Amuse-bouche&#34;&gt;amuse-bouches&lt;/a&gt; word play.&lt;/p&gt;
&lt;p&gt;Here are some R code bits from the conference. Hopefully convincing enough to start using a new package or change a workflow. Not everything was brand-new, but it was helpful to have someone talking through their inspiration and examples.&lt;/p&gt;
&lt;p&gt;Check out the speakers’ materials - soon there will be recordings too. Some of the examples are also copied straight from the speakers’ slide decks.&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;a href=&#34;#tidy-eval&#34;&gt;Tidy eval&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#usethis&#34;&gt;usethis&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#pak&#34;&gt;pak&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reshaping-data&#34;&gt;Reshaping data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#vroom&#34;&gt;vroom&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#datatable&#34;&gt;data.table&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#rray&#34;&gt;rray&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;!------------------ -------------------&gt;
&lt;div id=&#34;tidy-eval&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;1. tidy eval&lt;/h2&gt;
&lt;!------------------ -------------------&gt;
&lt;p&gt;Speaker: &lt;a href=&#34;https://twitter.com/_lionelhenry&#34;&gt;Lionel Henry&lt;/a&gt; (&lt;a href=&#34;https://speakerdeck.com/lionelhenry/reusing-tidyverse-code&#34;&gt;Slides&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;I never warmed up to the bang-bangs and enquo’s. Hence the new and more straight forward “curly-curly”’s for functional programming &lt;code&gt;{{ arg }}&lt;/code&gt; in the tidyverse feel like a game-changer.&lt;/p&gt;
&lt;p&gt;For those more familiar with the previous framework: &lt;code&gt;{{ arg }}&lt;/code&gt; is a shortcut for &lt;code&gt;!!enquo(arg)&lt;/code&gt;.&lt;/p&gt;
&lt;div id=&#34;dplyr-example&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;dplyr example&lt;/h3&gt;
&lt;p&gt;Let’s say you have a dataset, here &lt;code&gt;iris&lt;/code&gt;, and you want to compute the average &lt;code&gt;Petal.Length&lt;/code&gt; for each &lt;code&gt;Species&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
iris %&amp;gt;% 
  group_by(Species) %&amp;gt;%
  summarise(avg = mean(Petal.Length, na.rm = TRUE))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 3 x 2
##   Species      avg
##   &amp;lt;fct&amp;gt;      &amp;lt;dbl&amp;gt;
## 1 setosa      1.46
## 2 versicolor  4.26
## 3 virginica   5.55&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can use the “curly-curly” brackets if you want to turn this small bit of code into a function &lt;code&gt;group_mean()&lt;/code&gt; with a &lt;code&gt;data&lt;/code&gt;, &lt;code&gt;by&lt;/code&gt; and &lt;code&gt;var&lt;/code&gt; argument&lt;a href=&#34;#fn2&#34; class=&#34;footnote-ref&#34; id=&#34;fnref2&#34;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt; (and want to pass the variables on in an unquoted way):&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;group_mean &amp;lt;- function(data, by, var) {
  
  data %&amp;gt;%
    group_by({{ by }}) %&amp;gt;%
    summarise(avg = mean({{ var }}, na.rm = TRUE))
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can then apply &lt;code&gt;group_mean()&lt;/code&gt; to any dataset that has a grouping and a continuous variable, for example, the mammals sleep dataset in &lt;code&gt;ggplot2&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
group_mean(data = msleep, by = vore, var = sleep_total)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;ggplot2-example&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;ggplot2 example&lt;/h3&gt;
&lt;p&gt;Another common tidy eval application is &lt;code&gt;ggplot2&lt;/code&gt;. In the example below, we want a customised plot: a scatterplot with a &lt;code&gt;geom_smooth&lt;/code&gt; on top of it.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
theme_set(theme_bw())
ggplot(data = iris, 
       aes(x = Sepal.Length, y = Petal.Length, group = Species, color = Species)
       ) +
  geom_point() +
  geom_smooth(method = &amp;quot;lm&amp;quot;) + 
  ggtitle(&amp;quot;Pack this plot into a function.&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://sinarueeger.github.io/post/2019-07-16-amuse-bouche-from-user-2019_files/figure-html/2019-07-16-amuse-bouche-from-user-2019-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Again, we can wrap the “curly-curly” brackets around the arguments and apply them to a different dataset.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot_point_smooth &amp;lt;- function(data, x, y, gr = NULL, method = &amp;quot;lm&amp;quot;) {
  
  ggplot(data = data, 
         aes({{ x }}, {{ y }}, group = {{ gr }}, color = {{ gr }})
         ) +
    geom_point() +
    geom_smooth(method = method)
  
}&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot_point_smooth(msleep, x = sleep_total, y = sleep_rem, gr = NULL) + 
  ggtitle(&amp;quot;Tidy eval with the msleep dataset&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;!------------------ -------------------&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;usethis&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;2. usethis&lt;/h2&gt;
&lt;!------------------ -------------------&gt;
&lt;p&gt;Speaker: &lt;a href=&#34;https://twitter.com/JennyBryan&#34;&gt;Jenny Bryan&lt;/a&gt; (&lt;a href=&#34;https://github.com/jennybc/2019-07_useR-toulouse-usethis&#34;&gt;Slides + Material + Demo&lt;/a&gt;)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;usethis&amp;quot;)
library(usethis)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Once upon a time, there was the package &lt;code&gt;devtools&lt;/code&gt;. Then &lt;code&gt;devtools&lt;/code&gt; became too large, and now the &lt;code&gt;usethis&lt;/code&gt; package is taking over some of the convenience functions for workflows.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;usethis&lt;/code&gt; is all about avoiding to copy+pasting. For example, there is a function to edit the &lt;code&gt;.Rprofile&lt;/code&gt; called &lt;code&gt;usethis::edit_r_profile()&lt;/code&gt;. Whenever there is a slightly complicated task ahead (say &lt;em&gt;restarting R&lt;/em&gt;), the &lt;code&gt;usethis&lt;/code&gt; package will talk you through the whole process.&lt;/p&gt;
&lt;p&gt;There are lots of &lt;code&gt;use_*&lt;/code&gt; to add or modify something to/in a project/package and three functions to create a package, a project or a github fork:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;code&gt;create_package()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;create_project()&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;create_from_github()&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;div id=&#34;create-a-package&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Create a package&lt;/h3&gt;
&lt;p&gt;If you want to create a package, do the following (see also &lt;a href=&#34;https://www.youtube.com/watch?v=3vsPMyTfT8I&amp;amp;feature=youtu.be&#34;&gt;screencast&lt;/a&gt;):&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## 1. create the package skeleton
create_package(&amp;quot;~/tmp/mypackage&amp;quot;)

## 2. use git
use_git()

## 3. add a license
use_mit_license()

## 4. run check
# install.packages(&amp;quot;devtools&amp;quot;)
devtools::check()

## 5. commit all files with git

## 6. set up git + github
use_github()
## will update the DESCRIPTION file

## 7. install the package
devtools::install()

## 8. add a rmarkdown readme file
use_readme_rmd()
## knit + commit + push

## 9. clean up if this was only a demo
## install.packages(&amp;quot;fs&amp;quot;)
## fs::dir_delete(&amp;quot;~/tmp/mypackage&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;!------------------ -------------------&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;pak&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;3. pak&lt;/h2&gt;
&lt;!------------------ -------------------&gt;
&lt;p&gt;Speaker: &lt;a href=&#34;https://twitter.com/GaborCsardi&#34;&gt;Gábor Csárdi&lt;/a&gt; (&lt;a href=&#34;https://github.com/gaborcsardi/pak-talk&#34;&gt;Slides&lt;/a&gt;)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;pak&amp;quot;) ## or
# devtools::install_github(&amp;quot;r-lib/pak&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It seems like &lt;code&gt;pak&lt;/code&gt; will make package installation - conventional and for projects - more intuitive. Before installing anything, &lt;code&gt;pak&lt;/code&gt; will give you a heads up on what will be installed or if there are any conflicts.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pak&lt;/code&gt; has two main functions: &lt;code&gt;pak::pkg_*&lt;/code&gt; and &lt;code&gt;pak:::proj_*&lt;/code&gt;&lt;/p&gt;
&lt;div id=&#34;conventional-package-installation&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Conventional package installation&lt;/h3&gt;
&lt;p&gt;Play around with &lt;code&gt;usethis&lt;/code&gt;&lt;a href=&#34;#fn3&#34; class=&#34;footnote-ref&#34; id=&#34;fnref3&#34;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt; and see what happens:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pak::pkg_install(&amp;quot;usethis&amp;quot;)
pak::pkg_remove(&amp;quot;usethis&amp;quot;)
pak::pkg_install(&amp;quot;r-lib/usethis&amp;quot;)
pak::pkg_status(&amp;quot;usethis&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;package-installation-for-projects&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Package installation for projects&lt;/h3&gt;
&lt;p&gt;First, create a project with &lt;code&gt;usethis&lt;/code&gt;, then install R packages directly into the project.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;usethis::create_project(&amp;quot;~/tmp/test&amp;quot;)

## check the directory
dir()

## initialise a dedicated R packages folder
pak:::proj_create()

## check the directory again
dir()

## check the DESCRIPTION file
readLines(&amp;quot;DESCRIPTION&amp;quot;)

## install usethis
pak:::proj_install(&amp;quot;usethis&amp;quot;)

## this installs dependencies into a private project library
readLines(&amp;quot;DESCRIPTION&amp;quot;)

## remove the project folder again
fs::dir_delete(&amp;quot;~/tmp/test&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;!------------------ -------------------&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;reshaping-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;4. Reshaping data&lt;/h2&gt;
&lt;!------------------ -------------------&gt;
&lt;p&gt;Speaker: &lt;a href=&#34;https://twitter.com/hadleywickham&#34;&gt;Hadley Wickham&lt;/a&gt; (&lt;a href=&#34;https://gist.github.com/hadley/eb5c97bfbf257d133a7337b33d9f02d1&#34;&gt;Demo&lt;/a&gt;)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;tidyverse/tidyr&amp;quot;)
library(tidyr)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What a history reshaping data in R already has! From &lt;code&gt;reshape&lt;/code&gt; to &lt;code&gt;melt&lt;/code&gt; + &lt;code&gt;cast&lt;/code&gt;, over to &lt;code&gt;gather&lt;/code&gt; + &lt;code&gt;spread&lt;/code&gt; and now &lt;code&gt;pivot_long&lt;/code&gt; + &lt;code&gt;pivot_wide&lt;/code&gt;. Reshaping data stays a mind-bending task, but hopefully, these &lt;code&gt;pivot_*&lt;/code&gt; functions will make life easier.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# devtools::install_github(&amp;quot;chrk623/dataAnim&amp;quot;)
# Master&amp;#39;s Thesis project by Charco Hui
library(dataAnim)

## Our two toy datasets
datoy_wide&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    Name English Maths
## 1   Ben    19.0  58.5
## 2   Sam     6.7  51.8
## 3 Sarah    14.9  45.1&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;datoy_long&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   Name Subject Score
## 1  Ben   Maths  10.0
## 2  Ben English  63.7
## 3  Sam   Maths  52.9
## 4  Sam English  75.6
## 5 Alex   Maths  88.8
## 6 Alex English  92.2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s reshape the datasets&lt;a href=&#34;#fn4&#34; class=&#34;footnote-ref&#34; id=&#34;fnref4&#34;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## lets make it longer
datoy_wide %&amp;gt;%
  pivot_longer(-Name, names_to = &amp;quot;Subject&amp;quot;, values_to = &amp;quot;Score&amp;quot;)

## lets make it wider
datoy_long %&amp;gt;%
  dplyr::mutate(Time = 1:nrow(datoy_long)) %&amp;gt;%
  pivot_wider(names_from = &amp;quot;Subject&amp;quot;, values_from = c(&amp;quot;Score&amp;quot;, &amp;quot;Time&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;!---------------- --------------------&gt;
&lt;/div&gt;
&lt;div id=&#34;vroom&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;5. vroom&lt;/h2&gt;
&lt;!---------------- --------------------&gt;
&lt;p&gt;Speaker: &lt;a href=&#34;https://twitter.com/jimhester_&#34;&gt;Jim Hester&lt;/a&gt; (&lt;a href=&#34;https://speakerdeck.com/jimhester/vroom&#34;&gt;Slides&lt;/a&gt; + &lt;a href=&#34;screen%20cast:%20bit.ly/vroom-yt&#34;&gt;Screencast&lt;/a&gt;)&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## install.packages(&amp;quot;vroom&amp;quot;)
library(vroom)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Importing large datasets into R can be a painful task. Especially if you only need a subset of the columns. And apparently, our thoughts drift off after 10 sec&lt;a href=&#34;#fn5&#34; class=&#34;footnote-ref&#34; id=&#34;fnref5&#34;&gt;&lt;sup&gt;5&lt;/sup&gt;&lt;/a&gt; starring at the screen where it is &lt;em&gt;still&lt;/em&gt; loading the dataset.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;data.table::fread()&lt;/code&gt; is always here to help. But now comes &lt;code&gt;vroom&lt;/code&gt;!&lt;/p&gt;
&lt;div id=&#34;get-some-largeish-data&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Get some large’ish data&lt;/h3&gt;
&lt;p&gt;First, we need some large dataset. To not burden our laptops too much&lt;a href=&#34;#fn6&#34; class=&#34;footnote-ref&#34; id=&#34;fnref6&#34;&gt;&lt;sup&gt;6&lt;/sup&gt;&lt;/a&gt;, we will go for some exome based &lt;a href=&#34;https://en.wikipedia.org/wiki/Genome-wide_association_study&#34;&gt;GWAS&lt;/a&gt; results.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Source: https://portals.broadinstitute.org/collaboration/giant/index.php/GIANT_consortium_data_files

path_to_file_1 &amp;lt;- &amp;quot;Height_AA_add_SV.txt.gz&amp;quot;
path_to_file_2 &amp;lt;- &amp;quot;BMI_African_American.fmt.gzip&amp;quot; 


## Height
download.file(
  &amp;quot;https://portals.broadinstitute.org/collaboration/giant/images/8/80/Height_AA_add_SV.txt.gz&amp;quot;,
  path_to_file_1)

## BMI
download.file(
  &amp;quot;https://portals.broadinstitute.org/collaboration/giant/images/3/33/BMI_African_American.fmt.gzip&amp;quot;,
  path_to_file_2)


## File size
## install.packages(&amp;quot;fs&amp;quot;)
fs::file_size(path_to_file_1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 4.39M&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;fs::file_size(path_to_file_2)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## 13.3M&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The two datasets have a mix of characters, numbers and decimals&lt;a href=&#34;#fn7&#34; class=&#34;footnote-ref&#34; id=&#34;fnref7&#34;&gt;&lt;sup&gt;7&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;vroom-vs-dt&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;vroom vs DT&lt;/h3&gt;
&lt;p&gt;Here is how &lt;code&gt;vroom&lt;/code&gt; works and a basic comparison to &lt;code&gt;data.table::fread&lt;/code&gt; (I let you do the proper &lt;a href=&#34;http://adv-r.had.co.nz/Profiling.html&#34;&gt;benchmarking&lt;/a&gt; yourself).&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)

## With vroom
giant_vroom &amp;lt;- vroom::vroom(path_to_file_1)
giant_vroom_subset &amp;lt;- giant_vroom %&amp;gt;% select(CHR, POS) %&amp;gt;% filter(CHR == 1)

## The equivalent with data.table
giant_DT &amp;lt;- data.table::fread(path_to_file_1)
giant_DT_subset &amp;lt;- giant_DT %&amp;gt;% select(CHR, POS) %&amp;gt;% filter(CHR == 1)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;col_select-for-the-win&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;col_select for the win&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Selecting columns
giant_vroom_select &amp;lt;- vroom::vroom(path_to_file_1, 
                                   col_select = list(SNPNAME, ends_with(&amp;quot;_MAF&amp;quot;)))
head(giant_vroom_select)

## Preventing columns from being imported
giant_vroom_remove &amp;lt;- vroom::vroom(path_to_file_1, 
                                   col_select = -ExAC_AFR_MAF)
head(giant_vroom_remove)

## Renaming on the fly
giant_vroom_rename &amp;lt;- vroom::vroom(path_to_file_1, 
                                   col_select = list(p = Pvalue, everything()))
head(giant_vroom_rename)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;combining-multiple-datasets&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Combining multiple datasets&lt;/h3&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data_combined &amp;lt;- vroom::vroom( 
                    c(path_to_file_1, path_to_file_2), 
                    id = &amp;quot;path&amp;quot;)
table(data_combined$path)&lt;/code&gt;&lt;/pre&gt;
&lt;!------------------ -------------------&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;data.table&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;6. data.table&lt;/h2&gt;
&lt;!------------------ -------------------&gt;
&lt;p&gt;Speaker: &lt;a href=&#34;https://twitter.com/arun_sriniv&#34;&gt;Arun Srinivasan&lt;/a&gt; (&lt;a href=&#34;https://t.co/TrvDVS07QD&#34;&gt;Slides&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;code&gt;data.table&lt;/code&gt; has a pretty cool feature&lt;a href=&#34;#fn8&#34; class=&#34;footnote-ref&#34; id=&#34;fnref8&#34;&gt;&lt;sup&gt;8&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;data.table&amp;quot;)
library(data.table)

## Create a giant data.table
p &amp;lt;- 2e6
dat &amp;lt;- data.table(x = sample(1e5, p, TRUE), y = runif(p))

## Let&amp;#39;s select a few rows
system.time(
  tmp &amp;lt;- dat[x %in% 2000:3000 ]
)

## do the same operation again
system.time(
  tmp &amp;lt;- dat[x %in% 2000:3000 ]
)&lt;/code&gt;&lt;/pre&gt;
&lt;!---------------- --------------------&gt;
&lt;/div&gt;
&lt;div id=&#34;rray&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;7. rray&lt;/h2&gt;
&lt;!---------------- --------------------&gt;
&lt;p&gt;Speaker: &lt;a href=&#34;https://twitter.com/dvaughan32&#34;&gt;Davis Vaughan&lt;/a&gt; (&lt;a href=&#34;https://github.com/DavisVaughan/2019-07-09_useR-2019-rray/blob/master/useR-2019-rray.pdf&#34;&gt;Slides&lt;/a&gt;)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# devtools::install_github(&amp;quot;r-lib/rray&amp;quot;)
## may take some time&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;rray&lt;/code&gt; can do two things that are otherwise annoying/counter-intuitive in R:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;broadcasting (recycling dimensions)&lt;/li&gt;
&lt;li&gt;subsetting (&lt;code&gt;bag[,1, drop = FALSE]&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;matrices-with-base-r&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Matrices with base-r&lt;/h3&gt;
&lt;p&gt;Let’s look at an example of matrix operations in base-r&lt;a href=&#34;#fn9&#34; class=&#34;footnote-ref&#34; id=&#34;fnref9&#34;&gt;&lt;sup&gt;9&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;First, we want to add two matrices with similar dimensions:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;mat_1 &amp;lt;- matrix(c(15, 10, 8, 6, 12, 9), byrow = FALSE, nrow = 2) 
mat_2 &amp;lt;- matrix(c(5, 2, 3), nrow = 1)

## broadcasting won&amp;#39;t work ❌
mat_1 + mat_2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Error in mat_1 + mat_2: non-conformable arrays&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Next, we want to select one matrix column:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dim(mat_1[,2:3]) ## selecting two columns is fine&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## subsetting won&amp;#39;t preserve the matrix class ❌
dim(mat_1[,1]) ## why not 2x1?&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## NULL&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;length(mat_1[,1]) ## ah, it turned into a vector!&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dim(mat_1[,1, drop = FALSE]) ## but with drop = FALSE we can keep it a matrix&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2 1&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;matrices-with-rray&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Matrices with rray&lt;/h3&gt;
&lt;p&gt;Let’s do now the same task with &lt;code&gt;rray&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(rray)

(mat_1_rray &amp;lt;- rray(c(15, 10, 8, 6, 12, 9), dim = c(2, 3)))
(mat_2_rray &amp;lt;- rray(c(5, 2, 3), dim = c(1, 3)))

## Broadcasting works ✓
mat_1_rray + mat_2_rray

## Subsetting works ✓
dim(mat_1_rray[,2:3])
dim(mat_1_rray[,1])

## smart functions
mat_1_rray / rray_sum(mat_1_rray, axes = 1)
rray_bind(mat_1_rray, mat_2_rray, .axis = 1)
rray_bind(mat_1_rray, mat_2_rray, .axis = 2)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;more-info&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;More info&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Program + Slides: &lt;a href=&#34;https://user2019.r-project.org/talk_schedule/&#34; class=&#34;uri&#34;&gt;https://user2019.r-project.org/talk_schedule/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Collection of slides during the conference by &lt;a href=&#34;https://twitter.com/S_Owla&#34;&gt;Praer (Suthira Owlarn)&lt;/a&gt;: &lt;a href=&#34;https://github.com/sowla/useR2019-materials&#34; class=&#34;uri&#34;&gt;https://github.com/sowla/useR2019-materials&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Recordings by the &lt;a href=&#34;https://www.youtube.com/channel/UC_R5smHVXRYGhZYDJsnXTwg&#34;&gt;R Consortium on Youtube&lt;/a&gt; (keynotes available, rest soon to be published)&lt;/li&gt;
&lt;/ul&gt;
&lt;!---------------- --------------------&gt;
&lt;!---------------- --------------------&gt;
&lt;/div&gt;
&lt;div id=&#34;last-but-not-least&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Last but not least&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;rstatsmeme&lt;/code&gt; package is a little gem discovered thanks to &lt;a href=&#34;https://twitter.com/ameisen_strasse&#34;&gt;Frie Preu&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# devtools::install_github(&amp;quot;favstats/rstatsmemes&amp;quot;)
library(rstatsmemes)
show_me_an_R_meme()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://sinarueeger.github.io/post/2019-07-16-amuse-bouche-from-user-2019_files/figure-html/2019-07-16-amuse-bouche-from-user-2019-21-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;I cannot wait to see the recordings to catch up with the parallel sessions that I missed!&lt;a href=&#34;#fnref1&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn2&#34;&gt;&lt;p&gt;See &lt;a href=&#34;https://speakerdeck.com/lionelhenry/reusing-tidyverse-code?slide=49&#34;&gt;Slide 49+&lt;/a&gt;.&lt;a href=&#34;#fnref2&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn3&#34;&gt;&lt;p&gt;See &lt;a href=&#34;https://github.com/gaborcsardi/pak-talk/blob/master/pkg.Rmd&#34;&gt;demo 1&lt;/a&gt;&lt;a href=&#34;#fnref3&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn4&#34;&gt;&lt;p&gt;See &lt;a href=&#34;https://gist.github.com/hadley/eb5c97bfbf257d133a7337b33d9f02d1&#34;&gt;demo&lt;/a&gt;&lt;a href=&#34;#fnref4&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn5&#34;&gt;&lt;p&gt;I can totally confirm that.&lt;a href=&#34;#fnref5&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn6&#34;&gt;&lt;p&gt;If you can, choose the &lt;a href=&#34;https://portals.broadinstitute.org/collaboration/giant/index.php/GIANT_consortium_data_files#2018_GIANT_and_UK_BioBank_Meta-analysis&#34;&gt;UKBB + GIANT meta analysis results&lt;/a&gt;, which are pretty large.&lt;a href=&#34;#fnref6&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn7&#34;&gt;&lt;p&gt;Apparently, characters are the most challenging ones for speed.&lt;a href=&#34;#fnref7&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn8&#34;&gt;&lt;p&gt;See &lt;a href=&#34;https://t.co/TrvDVS07QD&#34;&gt;slides 26&lt;/a&gt;&lt;a href=&#34;#fnref8&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn9&#34;&gt;&lt;p&gt;See also &lt;a href=&#34;https://github.com/DavisVaughan/2019-07-09_useR-2019-rray/blob/master/useR-2019-rray.pdf&#34;&gt;slide 5&lt;/a&gt;.&lt;a href=&#34;#fnref9&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>A guide to poster making for scientific conferences</title>
      <link>https://sinarueeger.github.io/post/scientific-poster/</link>
      <pubDate>Mon, 10 Jun 2019 00:00:00 +0000</pubDate>
      
      <guid>https://sinarueeger.github.io/post/scientific-poster/</guid>
      <description>

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#how-to-make-a-good-poster&#34;&gt;How to make a good poster&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#recipe&#34;&gt;Recipe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#content&#34;&gt;Content&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#design&#34;&gt;Design&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This is a tutorial on how to make a scientific poster from scratch.&lt;/p&gt;

&lt;p&gt;It aims for first-time poster makers, but also for people like me that quickly lose themselves in choosing the right font for hours.&lt;/p&gt;

&lt;p&gt;It includes a few self-declared best practices that helped me in the past. Those are at best ideas, and barely opinions. It is by no means a collection of strict rules and feedback is welcome!&lt;/p&gt;

&lt;p&gt;I got lots of tips from &lt;a href=&#34;https://twitter.com/FlaviaHodel&#34; target=&#34;_blank&#34;&gt;Flavia Hodel&lt;/a&gt; during stimulating discussions around poster presentation. Flavia also gave valueable feedback after reading through a draft.&lt;/p&gt;

&lt;h2 id=&#34;how-to-make-a-good-poster&#34;&gt;How to make a good poster&lt;/h2&gt;

&lt;p&gt;An excellent &lt;a href=&#34;https://www.youtube.com/watch?v=1RwJbhkCA58&#34; target=&#34;_blank&#34;&gt;video&lt;/a&gt; by &lt;a href=&#34;https://twitter.com/mikemorrison&#34; target=&#34;_blank&#34;&gt;Mike Morrison&lt;/a&gt; recently made the rounds online. If you have not done so already, watch it before continuing.&lt;/p&gt;

&lt;p&gt;Mike Morrison makes the point that most of the posters presented at conferences are not easy to grasp.&lt;/p&gt;

&lt;p&gt;There are two principal reasons for this:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;The content is not adapted for a poster presentation. For example reusing whole paragraphs from a manuscript.&lt;/li&gt;
&lt;li&gt;Poor design choices. For example small fonts, problematic colour choices, low-resolution figures.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Separating content from design is important&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:If-you-know-Mark&#34;&gt;&lt;a href=&#34;#fn:If-you-know-Mark&#34;&gt;1&lt;/a&gt;&lt;/sup&gt; because it will allow you to focus only on one or the other. And since &amp;ldquo;design&amp;rdquo; is a profession, a better description in what we are doing is &amp;ldquo;polishing&amp;rdquo; or &amp;ldquo;improving readability&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;I will structure my tips into these two parts: &lt;a href=&#34;#content&#34;&gt;content&lt;/a&gt; and &lt;a href=&#34;#design&#34;&gt;design&lt;/a&gt;, along with a &lt;a href=&#34;#recipe&#34;&gt;recipe&lt;/a&gt; that I like to follow.&lt;/p&gt;

&lt;p&gt;But let&amp;rsquo;s talk first about what makes a poster presentation special.&lt;/p&gt;

&lt;h2 id=&#34;oral-versus-poster-presentation&#34;&gt;Oral versus poster presentation&lt;/h2&gt;

&lt;p&gt;If you get an oral presentation (congrats!), then you know that your voice will carry most of the talk. While your slides should be &lt;a href=&#34;http://damian.conway.org/IBP.pdf&#34; target=&#34;_blank&#34;&gt;carefully designed&lt;/a&gt;, you can still rescue imperfect slides with a good talk.&lt;/p&gt;

&lt;p&gt;Poster presentations are somewhat special because they are at an intersection of a talk and an art exhibition. Meaning, you will once during the conference have the opportunity to guide other researchers through your poster. This is similar to a lightning talk, just more engaging.&lt;/p&gt;

&lt;p&gt;The remainder of the conference, your poster will hang there, and maybe some people will still try to understand your topic. No matter how good you are at talking, now the poster has to be self explainable.&lt;/p&gt;

&lt;p&gt;In fact, your poster should read like going through stand-alone slides (slides with more explanations to replace the speakers&amp;rsquo; voice).&lt;/p&gt;

&lt;h2 id=&#34;back-to-the-video&#34;&gt;Back to the video&lt;/h2&gt;

&lt;p&gt;While overall the video of Mike Morrison is excellent, I struggle with three things.&lt;/p&gt;

&lt;p&gt;First, it talks about emphasising this very clear conclusion. In real life, this is often not possible. For example, because a research project has just started. So instead of having this one research question, I&amp;rsquo;d go for the main message - what do you want that people remember? That can be the large sample size of your study or that you are developing a new method.&lt;/p&gt;

&lt;p&gt;Second, the poster template still crams the details of the study into a small space, which is not ideal for readability.&lt;/p&gt;

&lt;p&gt;Third, it talks about a horizontal&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:Update-As-Peter&#34;&gt;&lt;a href=&#34;#fn:Update-As-Peter&#34;&gt;2&lt;/a&gt;&lt;/sup&gt; poster, and this is often not possible at conferences, due to space constraints&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:However-a-straig&#34;&gt;&lt;a href=&#34;#fn:However-a-straig&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;recipe&#34;&gt;Recipe&lt;/h2&gt;

&lt;p&gt;Here is a recipe that I like to follow when I make a poster.&lt;/p&gt;

&lt;h3 id=&#34;get-ready&#34;&gt;Get ready&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Start at least &lt;strong&gt;7 days&lt;/strong&gt; before the poster needs to go into print&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:Make-sure-you-kn&#34;&gt;&lt;a href=&#34;#fn:Make-sure-you-kn&#34;&gt;4&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Think of the &lt;strong&gt;main message&lt;/strong&gt;: what is the one thing that you want the reader to remember? Write that message into a text file.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Take a pen and &lt;strong&gt;sketch a draft&lt;/strong&gt; of your poster on an A4 paper. &lt;em&gt;What do you want to present and where does this content go on the poster? What kind of figures and tables to you want the reader to see?&lt;/em&gt; No need to write proper sentences, instead use keywords and skeletons of figures and tables. You can also do this step at a later stage, basically whatever suits you best for your creative process. For example, you might want to do first steps 4-7 before sketching a draft.
&lt;iframe src=&#34;https://giphy.com/embed/1W88Z61vUGMQo&#34; width=&#34;480&#34; height=&#34;360&#34; frameBorder=&#34;0&#34; class=&#34;giphy-embed&#34; allowFullScreen&gt;&lt;/iframe&gt;&lt;p&gt;&lt;a href=&#34;https://giphy.com/gifs/painting-the-addams-family-morticia-1W88Z61vUGMQo&#34;&gt;&lt;/a&gt;&lt;/p&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Get your abstract and extract &lt;strong&gt;title, author and affiliation&lt;/strong&gt; and save it into a text file too.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Create a folder &lt;code&gt;img&lt;/code&gt; somewhere on your computer.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Copy all &lt;strong&gt;text, tables and figures&lt;/strong&gt; you possibly need into the &lt;code&gt;img&lt;/code&gt; folder. Slides from previous talks can be a handy source.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Get the &lt;strong&gt;logos&lt;/strong&gt; of your university and affiliations and store them into the &lt;code&gt;img&lt;/code&gt; folder too. If you have the choice, go for PNGs, as they have &lt;a href=&#34;https://www.quora.com/What-is-the-difference-between-jpeg-and-png-files&#34; target=&#34;_blank&#34;&gt;transparent backgrounds&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Choose a &lt;strong&gt;tool&lt;/strong&gt; that is easy to operate and does the things you want. My choice is &lt;a href=&#34;https://www.apple.com/lae/keynote/&#34; target=&#34;_blank&#34;&gt;keynote&lt;/a&gt; because I cannot bother with Adobe Illustrator. More details &lt;a href=&#34;#tooling&#34;&gt;below&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;em&gt;Update:&lt;/em&gt; Read the &lt;strong&gt;conference instructions&lt;/strong&gt;, particularly on poster size and orientation (as recommended by &lt;a href=&#34;https://twitter.com/ibddoctor/status/1138743458418561024&#34; target=&#34;_blank&#34;&gt;Peter Higgins&lt;/a&gt;).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;Resize document&lt;/strong&gt; to the size recommended by the conference or A0 (&lt;a href=&#34;http://www.printernational.org/iso-paper-sizes.php&#34; target=&#34;_blank&#34;&gt;841 mm x 1189 mm or 2384 pt x 3370 pt&lt;/a&gt;). This way, even though the poster might be proportional to A4, you can use the real size fonts.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;Split&lt;/strong&gt; the document into different boxes (or any compartmentation according to your sketch). For example four horizontal lines and one vertical lines will turn 10 boxes. Use &lt;em&gt;rulers&lt;/em&gt;, &lt;em&gt;guides&lt;/em&gt; or lines to help you with that. Each box will later answer a different question.  &lt;img src=&#34;https://sinarueeger.github.io/post/2019-05-20-poster/illustration/illustration.001.png&#34; alt=&#34;drawing&#34; style=&#34;width:200px;&#34;/&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Now you are ready to add content.&lt;/p&gt;

&lt;h3 id=&#34;add-content&#34;&gt;Add content&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Before adding content, choose a &lt;strong&gt;sans-serif font&lt;/strong&gt;. &lt;font face=&#34;Helvetica&#34;&gt;Helvetica&lt;/font&gt; or &lt;font face=&#34;Arial&#34;&gt;Arial&lt;/font&gt; will do a good job. These fonts were carefully designed to be easy to read and look good on print. Later on, you can still decide to invest time into checkout &lt;a href=&#34;https://fonts.google.com/?category=Sans+Serif&#34; target=&#34;_blank&#34;&gt;google fonts&lt;/a&gt;, but remember - it needs to be sans-serif. The smallest text size should be &lt;a href=&#34;https://guides.library.ucla.edu/c.php?g=223540&amp;amp;p=1480858&#34; target=&#34;_blank&#34;&gt;24 pt&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Fill the top rectangles.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Place the &lt;strong&gt;title on top&lt;/strong&gt;. This is the first thing the reader should see.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Add &lt;strong&gt;authors and affiliation&lt;/strong&gt; right below.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Add the &lt;strong&gt;logos&lt;/strong&gt; next to the authors and affiliations.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Next, add your main message below. &lt;img src=&#34;https://sinarueeger.github.io/post/2019-05-20-poster/illustration/illustration.002.png&#34; alt=&#34;drawing&#34; style=&#34;width:200px;&#34;/&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Add &lt;a href=&#34;#contact&#34;&gt;&lt;strong&gt;contact and lab webpage&lt;/strong&gt;&lt;/a&gt; at the very bottom of the poster. &lt;img src=&#34;https://sinarueeger.github.io/post/2019-05-20-poster/illustration/illustration.003.png&#34; alt=&#34;drawing&#34; style=&#34;width:200px;&#34;/&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;No need to adjust and fiddle around with boxes at this stage. Just fill the &lt;a href=&#34;#content&#34;&gt;content&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Now we are left with 7 boxes. How you distribute the content into these boxes depends on your topic. I work in a field where data and methodology is central, so I always dedicate one box to data and one box to methods. &lt;img src=&#34;https://sinarueeger.github.io/post/2019-05-20-poster/illustration/illustration.004.png&#34; alt=&#34;drawing&#34; style=&#34;width:200px;&#34;/&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The first box will take care of the &lt;a href=&#34;#introduction&#34;&gt;&lt;strong&gt;introduction&lt;/strong&gt;&lt;/a&gt; and should answer the question &lt;em&gt;Why is your research needed?&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The second box should present the &lt;a href=&#34;#methods&#34;&gt;&lt;strong&gt;methods&lt;/strong&gt;&lt;/a&gt;: &lt;em&gt;What method did you use to answer your research question?&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The third box takes care of &lt;a href=&#34;#data&#34;&gt;&lt;strong&gt;data&lt;/strong&gt;&lt;/a&gt; presentation: &lt;em&gt;What kind of data did you use and how does it fit together with the method?&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The fourth and fifth box are reserved for &lt;a href=&#34;#results&#34;&gt;&lt;strong&gt;results&lt;/strong&gt;&lt;/a&gt;: &lt;em&gt;What are the results if you combine data and methods?&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The six box is dedicated to a &lt;a href=&#34;#discussion&#34;&gt;&lt;strong&gt;discussion&lt;/strong&gt;&lt;/a&gt; or summary: &lt;em&gt;What can you conclude from the results? What are the limitations? And where are you heading next?&lt;/em&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The seventh box is for &lt;a href=&#34;#references&#34;&gt;&lt;strong&gt;references and abbreviations&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;em&gt;Update&lt;/em&gt;: Add a small portrait of yours to the upper corners or next to your contact email address. This way people can spot and talk to you outside the poster session (recommended by &lt;a href=&#34;https://twitter.com/FedeBioinfo/status/1139452165800546304&#34; target=&#34;_blank&#34;&gt;Federico Marini&lt;/a&gt;).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;em&gt;Update&lt;/em&gt;: Add some empty post-it notes and a pencil next to your poster and ask readers for feedback (recommended by &lt;a href=&#34;https://twitter.com/FedeBioinfo/status/1139513676191412224&#34; target=&#34;_blank&#34;&gt;Federico Marini&lt;/a&gt;).&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;polishing-design&#34;&gt;Polishing &amp;amp; Design&lt;/h3&gt;

&lt;p&gt;Now that you have all your content, you can start to &lt;strong&gt;improve the readability&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;In order to quickly grasp a poster, it should have &lt;strong&gt;as less sentences as possible&lt;/strong&gt;.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Consider replacing some text with &lt;strong&gt;icons or figures&lt;/strong&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Make use of &lt;strong&gt;bullet points&lt;/strong&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;Align&lt;/strong&gt; all text and shapes (again, rulers might help here).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Make sure all section titles are &lt;strong&gt;equally sized&lt;/strong&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Are your figures (and the rest of your poster) &lt;a href=&#34;#colourblind&#34;&gt;&lt;strong&gt;colour-blind friendly&lt;/strong&gt;&lt;/a&gt;?&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;You can start adding &lt;a href=&#34;#colourblind&#34;&gt;colours&lt;/a&gt; (if they serve a purpose).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Think about whether your figures need captions or not.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;finalising&#34;&gt;Finalising&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;See how it looks like on a &lt;strong&gt;printed A4 version&lt;/strong&gt; (&lt;em&gt;update&lt;/em&gt;: or for less troublesome reading print it on A3, as mentioned by &lt;a href=&#34;https://twitter.com/Sakkaden/status/1138562946680860677&#34; target=&#34;_blank&#34;&gt;Michael MacAskill&lt;/a&gt;).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;strong&gt;Ask your colleagues&lt;/strong&gt; for their opinion by showing them the printed version.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;You might want to let it sit for a day or two. Then look at it with fresh and rested eyes.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;trick-trick-have-a-detailed-and-a-lean-version&#34;&gt;Trick-trick: Have a detailed and a lean version&lt;/h3&gt;

&lt;p&gt;After a few days break you look at it again and you realise that it is still to busy with text.&lt;/p&gt;

&lt;p&gt;Here is the trick - &lt;strong&gt;keep two versions&lt;/strong&gt;: the detailed one you already made (that can be accessed through a QR code), and the one that you will bring to the poster session with lot less details.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Make a copy&lt;/strong&gt; of your poster draft, name it &lt;code&gt;poster_detailed.pdf&lt;/code&gt;. Put this pdf somewhere online (e.g. dropbox, google drive) and get a link to it.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Generate a &lt;a href=&#34;https://www.qr-code-generator.com/&#34; target=&#34;_blank&#34;&gt;QR-code&lt;/a&gt; of that link and download the png to your &lt;code&gt;img/&lt;/code&gt; folder.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Continue working on your original file.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Count your words. Your aim is now to cut the number of words in half - roughly. If you don&amp;rsquo;t know where to remove content, &lt;strong&gt;present your poster to a colleague&lt;/strong&gt; from the same faculty (not the same lab). You will quickly realise over what details you jump. Remove those details.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;If you can &lt;strong&gt;simplify the graphs&lt;/strong&gt; - do that too.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Count the words again - has it been halfed?&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Add the &lt;strong&gt;QR-code&lt;/strong&gt; to the bottom of the poster.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;printing&#34;&gt;Printing&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Print it again in A4 for yourself and check:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;if all text and shapes are aligned and equally distributed,&lt;/li&gt;
&lt;li&gt;if the font is the same throughout the poster,&lt;/li&gt;
&lt;li&gt;if all authors or affiliations are present,&lt;/li&gt;
&lt;li&gt;for typos,&lt;/li&gt;
&lt;li&gt;if figures are clearly readable (and in high resolution),&lt;/li&gt;
&lt;li&gt;where the QR-code leads you,&lt;/li&gt;
&lt;li&gt;whether your contact email address is correct.
&lt;br /&gt;
&lt;br /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;That&amp;rsquo;s it - send it to the printing service!&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;content&#34;&gt;Content&lt;/h2&gt;

&lt;p&gt;Before adding any content, think about your audience. These will be scientists, and they have probably heard about research you are working on, but don&amp;rsquo;t know the details and motivation behind your work. In fact, there will only be a handful of people that know exactly what your domain, topic and method does. All others are still interested though. So lets aim for these people as your audience.&lt;/p&gt;

&lt;p&gt;After looking at your poster, the reader should have an idea what the title means. Your poster title might be super clear to you and your lab colleagues, but anyone else will have a hard time understanding right away what you are doing.&lt;/p&gt;

&lt;p&gt;Therefore, one goal is, to clarify the words in your title.&lt;/p&gt;

&lt;p&gt;After separating your file with rulers as described &lt;a href=&#34;#recipe&#34;&gt;above&lt;/a&gt;, you will have 8 boxes, of which you can use 6 for:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Introduction&lt;/li&gt;
&lt;li&gt;Method&lt;/li&gt;
&lt;li&gt;Data&lt;/li&gt;
&lt;li&gt;General results&lt;/li&gt;
&lt;li&gt;Specific results&lt;/li&gt;
&lt;li&gt;Discussion &amp;amp; Summary&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I recommend to give your boxes titles so the reader can jump from one to the other.&lt;/p&gt;

&lt;p&gt;What content should go in your boxes?&lt;/p&gt;

&lt;p&gt;I believe that a poster cannot carry a condensed version of a full manuscript. I think it is ok to focus on only one or two threads of your work. Your story telling needs to be coherent - that is all the reader wants.&lt;/p&gt;

&lt;h3 id=&#34;introduction&#34;&gt;Introduction&lt;/h3&gt;

&lt;p&gt;I like to follow the &lt;a href=&#34;https://cs.stanford.edu/people/widom/paper-writing.html&#34; target=&#34;_blank&#34;&gt;paper writing guidelines&lt;/a&gt; by &lt;a href=&#34;https://cs.stanford.edu/people/widom/&#34; target=&#34;_blank&#34;&gt;Jennifer Widom&lt;/a&gt; as a rough guide:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;What is the problem?&lt;/li&gt;
&lt;li&gt;Why is it interesting and important?&lt;/li&gt;
&lt;li&gt;Why is it hard?&lt;/li&gt;
&lt;li&gt;Why hasn&amp;rsquo;t it been solved before?&lt;/li&gt;
&lt;li&gt;What are the key components of my approach and results?&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;methods&#34;&gt;Methods&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Unless your very focus is a new statistical methods, keep this section simple and clear.&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;Make sure that it is clear why the method is able to answer your research question.&lt;/li&gt;
&lt;li&gt;You can use equations, but simplify them too, or annotate them with arrows and explain all fancy letters used.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;data&#34;&gt;Data&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Mention the origin(s) of your data.&lt;/li&gt;
&lt;li&gt;What was the sample size?&lt;/li&gt;
&lt;li&gt;No need to describe all the variables you used. To save space, you can also group them into larger categories.&lt;/li&gt;
&lt;li&gt;Describe distinct features of your data that could influence the interpretation: e.g. if all your samples were male.&lt;/li&gt;
&lt;li&gt;Mention how you processed the data. Again, no need to be specific. If your area uses standard QC methods, mention that the data was processed according to standard QC techniques.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;results&#34;&gt;Results&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Have two layers of detail. For example, go from general to specific; have a graph that summarises your results, then zoom into your results in a next graph.&lt;/li&gt;
&lt;li&gt;Use figures to illustrate your results and avoid tables.&lt;/li&gt;
&lt;li&gt;Simplify the figures and use the power of your poster making tool to annotate the figures.&lt;/li&gt;
&lt;li&gt;Make sure that the results are follow the notation of data and methodology. E.g. if you present results for a trend in age, make sure you have mentioned age before.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;discussion&#34;&gt;Discussion&lt;/h3&gt;

&lt;p&gt;This is the place to:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;summarise your work&lt;/li&gt;
&lt;li&gt;conclude&lt;/li&gt;
&lt;li&gt;talk about limitations&lt;/li&gt;
&lt;li&gt;announce future plans&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;contact&#34;&gt;Contact&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Add your email address.&lt;/li&gt;
&lt;li&gt;Add lab webpage.&lt;/li&gt;
&lt;li&gt;Add the QR code that leads to your (detailed) poster.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;references&#34;&gt;References&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Add important references, for example software that you used.&lt;/li&gt;
&lt;li&gt;Make sure you cite original content.&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;design&#34;&gt;Design&lt;/h2&gt;

&lt;p&gt;Or &lt;em&gt;improving readability&lt;/em&gt;.&lt;/p&gt;

&lt;h3 id=&#34;tooling&#34;&gt;Tooling&lt;/h3&gt;

&lt;p&gt;A good tool should satisfy the following criteria:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Decent in zooming in and out.&lt;/li&gt;
&lt;li&gt;Variety of graphical options.&lt;/li&gt;
&lt;li&gt;Operable with ease.&lt;/li&gt;
&lt;li&gt;Something you can use over years.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you have practice with Adobe Illustrator or its&amp;rsquo; open-source counterpart &lt;a href=&#34;https://inkscape.org/&#34; target=&#34;_blank&#34;&gt;Inkscape&lt;/a&gt; - go for it!&lt;/p&gt;

&lt;p&gt;Otherwise, &lt;a href=&#34;https://www.google.com/slides/about/&#34; target=&#34;_blank&#34;&gt;google slides&lt;/a&gt;, Powerpoint, &lt;a href=&#34;https://www.apple.com/lae/keynote/&#34; target=&#34;_blank&#34;&gt;keynote&lt;/a&gt; - although limiting - do a the job too.&lt;/p&gt;

&lt;h3 id=&#34;fonts&#34;&gt;Fonts&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;No matter what sophisticated typeface you had in mind, choose one of these sans-serif ones for a start: &lt;font face=&#34;Helvetica&#34;&gt;Helvetica&lt;/font&gt; or &lt;font face=&#34;Arial&#34;&gt;Arial&lt;/font&gt;.&lt;/li&gt;
&lt;li&gt;If you really have the time to play with other sans-serif fonts, check out &lt;a href=&#34;https://fonts.google.com/?category=Sans+Serif&#34; target=&#34;_blank&#34;&gt;google fonts&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Making fonts is an actual job - remember to pay for special fonts.&lt;/li&gt;
&lt;li&gt;Most tools have a &lt;code&gt;replace font&lt;/code&gt; option, so you can replace a font through out your poster.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;font-size&#34;&gt;Font size&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Minimum 24 pt, but use it sparingly.&lt;/li&gt;
&lt;li&gt;Title should be largest with somewhere in between 100 and 140 pt.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;icons&#34;&gt;Icons&lt;/h3&gt;

&lt;p&gt;Some icon services are for free, or at least partially: e.g. &lt;a href=&#34;https://www.flaticon.com/&#34; target=&#34;_blank&#34;&gt;flat icon&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;figures&#34;&gt;Figures&lt;/h3&gt;

&lt;p&gt;Principles for data visualisations could easily occupy another blog post. There is much to say, but let&amp;rsquo;s keep it short here.&lt;/p&gt;

&lt;p&gt;If you use R and ggplot2 for making your figures, use one of the black and white themes, e.g. &lt;code&gt;theme_set(theme_linedraw())&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Make sure that the axis text size is also 24pt once it is on the poster.&lt;/p&gt;

&lt;h3 id=&#34;colours-a-name-colourblind-a&#34;&gt;Colours&lt;a name=&#34;colourblind&#34;&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Colours are either used as decoration or to encode a variable. Do not use colour for your background&lt;sup class=&#34;footnote-ref&#34; id=&#34;fnref:Black-or-gray-ba&#34;&gt;&lt;a href=&#34;#fn:Black-or-gray-ba&#34;&gt;5&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Always&lt;/strong&gt; use &lt;a href=&#34;http://blogs.nature.com/nautilus/2007/02/post_4.html&#34; target=&#34;_blank&#34;&gt;colour-blind friendly colours&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;You can test the colour-blind friendlyness of your poster and figures with &lt;a href=&#34;https://colororacle.org&#34; target=&#34;_blank&#34;&gt;https://colororacle.org&lt;/a&gt;, a colour-blindness simulator on your computer, or in a browser: &lt;a href=&#34;https://www.color-blindness.com/coblis-color-blindness-simulator/&#34; target=&#34;_blank&#34;&gt;https://www.color-blindness.com/coblis-color-blindness-simulator/&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;For Figures:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;If you use more colours than available in a discrete colour palette - drop that encoding. No one will be able to grasp.&lt;/li&gt;
&lt;li&gt;Use colour-blind friendly palettes from the &lt;a href=&#34;https://github.com/clauswilke/colorblindr/blob/master/R/palettes.R&#34; target=&#34;_blank&#34;&gt;colorblindr&lt;/a&gt; R-package.&lt;/li&gt;
&lt;/ul&gt;

&lt;!---------
```r

library(colorblindr)
library(dplyr)
library(kableExtra)
dat &lt;- data.frame(hex = colorblindr::palette_OkabeIto, swatch = colorblindr::palette_OkabeIto)


dat %&gt;%
  mutate(swatch = cell_spec(
    swatch, color = &#34;white&#34;, bold = T,
    background = hex
  )) %&gt;%
  kable(escape = F, align = &#34;c&#34;) %&gt;%
  kable_styling(c(&#34;striped&#34;, &#34;condensed&#34;), full_width = F)
```
----&gt;

&lt;h3 id=&#34;resolution-of-figures&#34;&gt;Resolution of figures&lt;/h3&gt;

&lt;p&gt;Your principal figures should &lt;em&gt;always&lt;/em&gt; be stored as PDF format. This way, you can easily turn them into a high-resolution PNG.&lt;/p&gt;

&lt;p&gt;To turn a PDF into a high-resolution raster image, use &lt;a href=&#34;https://imagemagick.org/script/convert.php&#34; target=&#34;_blank&#34;&gt;convert from imagemagick&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If your file is called &lt;code&gt;figure-1.pdf&lt;/code&gt;, then write:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;convert -quality 100 -background white -alpha background -compress lzw -units pixelsperinch -resize &amp;quot;789x2625&amp;quot; -density 300 figure-1.pdf figure-1b.png
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you have lots of pdf starting with &lt;code&gt;figure-*&lt;/code&gt;, then write:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;for file in figure-*.pdf; do \
echo $file;\
convert -quality 100 -background white -alpha background -compress lzw -flatten -units pixelsperinch -resize &amp;quot;789x2625&amp;quot; -density 300 $file `echo $file|cut -f1 -d&#39;.&#39;`.png;\
done
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;links&#34;&gt;Links&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://guides.library.ucla.edu/c.php?g=223540&amp;amp;p=1480858tag&#34; target=&#34;_blank&#34;&gt;https://guides.library.ucla.edu/c.php?g=223540&amp;amp;p=1480858tag&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://blogs.nature.com/naturejobs/2017/11/06/using-design-principles-to-inform-scientific-posters/&#34; target=&#34;_blank&#34;&gt;http://blogs.nature.com/naturejobs/2017/11/06/using-design-principles-to-inform-scientific-posters/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Update:&lt;/em&gt; &lt;a href=&#34;https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.0030102&#34; target=&#34;_blank&#34;&gt;Ten Simple Rules for a Good Poster Presentation (Plos CompBio)&lt;/a&gt; (mentioned by &lt;a href=&#34;https://twitter.com/FedeBioinfo&#34; target=&#34;_blank&#34;&gt;Federico Marini&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;full-disclosure&#34;&gt;Full disclosure&lt;/h2&gt;

&lt;p&gt;Here are some of my posters from different stages of my career. Making posters is a process of improvement.&lt;/p&gt;

&lt;h3 id=&#34;2018&#34;&gt;2018&lt;/h3&gt;

&lt;figure&gt;
  &lt;img src=&#34;https://sinarueeger.github.io/post/2019-05-20-poster/posters-sina/poster-2018.png&#34; width=&#34;300&#34; height=&#34;300&#34;
    alt=&#34;Poster 2018&#34;&gt;
&lt;/figure&gt;

&lt;h3 id=&#34;2017&#34;&gt;2017&lt;/h3&gt;

&lt;figure&gt;
  &lt;img src=&#34;https://sinarueeger.github.io/post/2019-05-20-poster/posters-sina/poster-2017.png&#34; width=&#34;300&#34; height=&#34;300&#34;
    alt=&#34;Poster 2017&#34;&gt;
&lt;/figure&gt;
&lt;div class=&#34;footnotes&#34;&gt;

&lt;hr /&gt;

&lt;ol&gt;
&lt;li id=&#34;fn:If-you-know-Mark&#34;&gt;If you know Markdown or LaTex, you know what I mean. &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:If-you-know-Mark&#34;&gt;&lt;sup&gt;^&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:Update-As-Peter&#34;&gt;&lt;em&gt;Update:&lt;/em&gt; As &lt;a href=&#34;https://twitter.com/ibddoctor/status/1138743458418561024&#34; target=&#34;_blank&#34;&gt;Peter Higgins&lt;/a&gt; pointed out, horizontal is common in the US, vertical is common in Europe. &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:Update-As-Peter&#34;&gt;&lt;sup&gt;^&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:However-a-straig&#34;&gt;However, a straight forward solution is, to turn the design by 90 degrees. &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:However-a-straig&#34;&gt;&lt;sup&gt;^&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:Make-sure-you-kn&#34;&gt;Make sure you know how much time the printing service needs to print your poster. &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:Make-sure-you-kn&#34;&gt;&lt;sup&gt;^&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li id=&#34;fn:Black-or-gray-ba&#34;&gt;Black or gray background and white text colour might work though. &lt;a class=&#34;footnote-return&#34; href=&#34;#fnref:Black-or-gray-ba&#34;&gt;&lt;sup&gt;^&lt;/sup&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Integrative Statistical Analysis of -omics and GWAS data</title>
      <link>https://sinarueeger.github.io/project/phd-thesis/</link>
      <pubDate>Tue, 28 May 2019 00:00:00 +0200</pubDate>
      
      <guid>https://sinarueeger.github.io/project/phd-thesis/</guid>
      <description>

&lt;p&gt;I finished my PhD under the main supervision of &lt;a href=&#34;https://wp.unil.ch/sgg/&#34;&gt;Zolt&amp;#225;n Kutalik&lt;/a&gt; in September 2018.&lt;/p&gt;

&lt;p&gt;You can download &lt;a href=&#34;https://drive.switch.ch/index.php/s/FpWZlbw4Rfq20le&#34; target=&#34;_blank&#34;&gt;my thesis&lt;/a&gt; or check out the &lt;a href=&#34;https://sinarueeger.github.io/publicdefense/slides#1&#34; target=&#34;_blank&#34;&gt;slides&lt;/a&gt; from my public defense.&lt;/p&gt;

&lt;h2 id=&#34;abstract&#34;&gt;Abstract&lt;/h2&gt;

&lt;p&gt;Increasing our knowledge about biology in humans is essential for advances in medicine, such as early-stage diagnoses of diseases, drug development, public health strategies, and precision medicine.
One approach to tackle this task is, to collect data on different components of a biological mechanism of interest, link these parts and try to construct an underlying model that helps us to explain the disease.
To collect data, DNA is measured and the status of a disease is recorded for each individual in a dedicated group of people.
In a first step, an analyst compares for each genetic variant across the whole genome the genetic mutations between people with the disease and healthy people; this is called a genome-wide association study (GWAS).
Such first association screens rarely point right away to the true causal variants, but combined with additional biomedical (-omics) data and additional statistical methods it is possible to narrow down the true cause and gain insight into the biology of a disease.
For example, by using GWAS results for two diseases (e.g. cardiovascular disease and obesity) and a statistical method called Mendelian randomisation, we are able to examine the causal effect of obesity on cardiovascular disease, or vice versa.
These statistical follow-up investigations often require GWAS results for genetic variants than were unmeasured.
During my PhD, I investigated a method called summary statistic imputation that precisely aims to solve the problem of inferring GWAS results for unmeasured genetic variants. Summary statistic imputation uses GWAS results and data from public sequencing data. My main findings were that imputation accuracy varies depending on certain characteristics of a genetic variant (e.g. low accuracy for rare mutations), as well as the size of publicly available sequencing data (low accuracy for small sized sequencing data).
A further finding is, that summary statistic imputation can compete with imputation techniques that are based on individual-level data for certain subgroups of genetic variants (e.g. common variants).&lt;/p&gt;

&lt;p&gt;With the help of summary statistic imputation researchers can facilitate follow-up investigations and thus gain more insight into the biology of diseases.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>R-package GWAS.utils</title>
      <link>https://sinarueeger.github.io/project/gwas.utils/</link>
      <pubDate>Tue, 28 May 2019 00:00:00 +0200</pubDate>
      
      <guid>https://sinarueeger.github.io/project/gwas.utils/</guid>
      <description></description>
    </item>
    
    <item>
      <title>R-package ggGWAS</title>
      <link>https://sinarueeger.github.io/project/gggwas/</link>
      <pubDate>Tue, 28 May 2019 00:00:00 +0200</pubDate>
      
      <guid>https://sinarueeger.github.io/project/gggwas/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Statistical Genetics Resources</title>
      <link>https://sinarueeger.github.io/project/stat-genetics-ressources/</link>
      <pubDate>Tue, 28 May 2019 00:00:00 +0200</pubDate>
      
      <guid>https://sinarueeger.github.io/project/stat-genetics-ressources/</guid>
      <description></description>
    </item>
    
    <item>
      <title>LD Part 1</title>
      <link>https://sinarueeger.github.io/post/get-ld-remotely/</link>
      <pubDate>Tue, 21 May 2019 00:00:00 +0000</pubDate>
      
      <guid>https://sinarueeger.github.io/post/get-ld-remotely/</guid>
      <description>
&lt;link href=&#34;https://sinarueeger.github.io/rmarkdown-libs/font-awesome/css/fontawesome-all.min.css&#34; rel=&#34;stylesheet&#34; /&gt;

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#goal&#34;&gt;Goal&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#two-approaches&#34;&gt;Two approaches&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#our-toy-data&#34;&gt;Our toy data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#a.-a-solution-that-works-ldlink-from-nih&#34;&gt;1A. A solution that works: ldlink from NIH&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#ldproxy&#34;&gt;LDproxy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#ldmatrix&#34;&gt;LDmatrix&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#b.-a-solution-that-almost-works-ensembl.org&#34;&gt;1B. A solution that almost works: ensembl.org&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#what-reference-panelspopulation-can-we-choose-from&#34;&gt;What reference panels/population can we choose from?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#access-ld-between-a-snp-and-its-region&#34;&gt;Access LD between a SNP and its region&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#access-ld-matrix&#34;&gt;Access LD matrix&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#access-ld-between-a-snp-and-many-other-snps&#34;&gt;Access LD between a SNP and many other SNPs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#coloured-locuszoom-plot&#34;&gt;Coloured locuszoom plot&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#solutions-that-work-half-through&#34;&gt;2. Solutions that work half-through&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#snpsnap&#34;&gt;SNPsnap&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#api-provided-by-sph.umich&#34;&gt;API provided by sph.umich&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#a-solution-that-does-not-work&#34;&gt;3. A solution that does not work&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#rsnpsld_search&#34;&gt;&lt;code&gt;rsnps::ld_search&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#conclusion&#34;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#session-info&#34;&gt;Session Info&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;R-packages used:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(httr)
library(jsonlite)
library(xml2)
library(ggplot2)
theme_set(theme_bw())
library(tibble)
library(tidyr)
library(magrittr)
library(glue)
library(purrr)
library(rsnps)
library(data.table)
library(janitor)
library(stringr)
library(rsnps)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The squared correlation between genetic markers is one way to estimate &lt;a href=&#34;https://ldlink.nci.nih.gov/?tab=help&#34;&gt;linkage disequilibrium&lt;/a&gt; (LD). LD has to be computed &lt;em&gt;all the time&lt;/em&gt; - either for as an input for statistical methods or to summarise results.&lt;/p&gt;
&lt;p&gt;However, accessing LD estimations quickly, for a specific population and in an automated way (e.g. with R) is suprisingly difficult.&lt;/p&gt;
&lt;p&gt;In this blog post I am exploring how to do this efficiently.&lt;/p&gt;
&lt;!---------- -------------------------------&gt;
&lt;div id=&#34;goal&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Goal&lt;/h2&gt;
&lt;!---------- -------------------------------&gt;
&lt;p&gt;At the end of this blog post, we want to know the genetic correlation between two or more markers in a specific human population, so that we can populate the locuszoom plot from the &lt;a href=&#34;https://sinarueeger.github.io/2018/07/30/locuszoomplot/&#34;&gt;previous blog post&lt;/a&gt; with coloured dots.&lt;/p&gt;
&lt;p&gt;For simplicity, I will use the terms correlation, squared correlation, r, r2 and LD interchangeably.&lt;/p&gt;
&lt;!---------- -------------------------------&gt;
&lt;/div&gt;
&lt;div id=&#34;two-approaches&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Two approaches&lt;/h2&gt;
&lt;!---------- -------------------------------&gt;
&lt;p&gt;In principle, there are two ways of doing accessing LD:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;Download (or access) the genetic data from which you want to estimate your correlations + calculate the correlations using some efficient approach.&lt;/li&gt;
&lt;li&gt;Access precomputed LD estimations.&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col width=&#34;9%&#34; /&gt;
&lt;col width=&#34;22%&#34; /&gt;
&lt;col width=&#34;39%&#34; /&gt;
&lt;col width=&#34;28%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th&gt;Approach &lt;i class=&#34;fas  fa-wrench &#34;&gt;&lt;/i&gt;&lt;/th&gt;
&lt;th&gt;Advantages &lt;i class=&#34;fas  fa-smile &#34;&gt;&lt;/i&gt;&lt;/th&gt;
&lt;th&gt;Downsides &lt;i class=&#34;fas  fa-frown &#34;&gt;&lt;/i&gt;&lt;/th&gt;
&lt;th&gt;Useful when…&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td&gt;(1) &lt;strong&gt;Local&lt;/strong&gt; computation of LD&lt;/td&gt;
&lt;td&gt;LD matrix can be quickly updated to new reference panels&lt;/td&gt;
&lt;td&gt;Requires large computation and storage space (e.g. 1000 Genomes is &lt;a href=&#34;https://console.cloud.google.com/storage/browser/genomics-public-data/1000-genomes-phase-3/vcf/?_ga=2.227457240.-473641130.1558969048&#34;&gt;&amp;gt;100 few GB large&lt;/a&gt;).&lt;/td&gt;
&lt;td&gt;i) LD for a large set of SNPs is needed ii) LD from non-standard reference panel is needed.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td&gt;(2) &lt;strong&gt;Access&lt;/strong&gt; precomputed LD&lt;/td&gt;
&lt;td&gt;not need for large computation and storage space.&lt;/td&gt;
&lt;td&gt;limited to certain small sets of markers, limited to possibly outdated reference panels.&lt;/td&gt;
&lt;td&gt;LD for a small set of SNPs is needed&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;For now, I will focus on approach (2), and then explore approach (1) in a future blog post.&lt;/p&gt;
&lt;p&gt;Spoiler: Using approach (2) does not get you far. It took me quite a while to gather all the solutions that are listed below, and yet there is not one perfect/ideal solution.&lt;/p&gt;
&lt;!---------- -------------------------------&gt;
&lt;/div&gt;
&lt;div id=&#34;our-toy-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Our toy data&lt;/h2&gt;
&lt;!---------- -------------------------------&gt;
&lt;p&gt;We will recycle the data from the &lt;a href=&#34;https://sinarueeger.github.io/2018/07/30/locuszoomplot/&#34;&gt;previous blog post&lt;/a&gt;, where the focus was on extracting annotation using the package &lt;code&gt;biomaRt&lt;/code&gt;. In this blog post, we will complete that locuszoom plot by adding the LD information.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Data Source URL
url &amp;lt;- &amp;quot;https://portals.broadinstitute.org/collaboration/giant/images/2/21/BMI_All_ancestry.fmt.gzip&amp;quot;

## Import BMI summary statistics dat.bmi &amp;lt;- read_tsv(file = url) ##
## taking too long, let&amp;#39;s use fread instead.

dat.bmi &amp;lt;- data.table::fread(url, verbose = FALSE)

## Rename some columns
dat.bmi &amp;lt;- dat.bmi %&amp;gt;% rename(SNP = SNPNAME, P = Pvalue)

## Extract region
dat.bmi.sel &amp;lt;- dat.bmi %&amp;gt;% slice(which.min(P))
dat.bmi.sel

## range region
range &amp;lt;- 5e+05
sel.chr &amp;lt;- dat.bmi.sel$CHR
sel.pos &amp;lt;- dat.bmi.sel$POS

data &amp;lt;- dat.bmi %&amp;gt;%
  filter(CHR == sel.chr, between(POS, sel.pos -
    range, sel.pos + range))

head(data)

(snp &amp;lt;- dat.bmi.sel$SNP)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What we are interested in is the LD between our top SNP rs1421085 and all other 82 SNPs nearby.&lt;/p&gt;
&lt;p&gt;This dataset has positions on build GRCh37, while most databases are on build GRCh38 by now.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sm &amp;lt;- rsnps::ncbi_snp_summary(snp) %&amp;gt;% separate(chrpos, c(&amp;quot;chr&amp;quot;, &amp;quot;pos&amp;quot;))
sel.pos == as.numeric(sm$pos)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] FALSE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s quickly repeat what our primary goal is:&lt;/p&gt;
&lt;p&gt;Extract the correlation between SNPs&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;without downloading any data,&lt;/li&gt;
&lt;li&gt;fairly quick and&lt;/li&gt;
&lt;li&gt;in R.&lt;/li&gt;
&lt;/ul&gt;
&lt;!---------- -------------------------------&gt;
&lt;/div&gt;
&lt;div id=&#34;a.-a-solution-that-works-ldlink-from-nih&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;1A. A solution that works: ldlink from NIH&lt;/h2&gt;
&lt;!---------- -------------------------------&gt;
&lt;p&gt;&lt;a href=&#34;https://ldlink.nci.nih.gov/?tab=home&#34;&gt;ldlink&lt;/a&gt; is a website provided by &lt;a href=&#34;https://dceg.cancer.gov/&#34;&gt;NIH&lt;/a&gt; to easily (and programmatically) request LD estimates in population groups.&lt;/p&gt;
&lt;p&gt;LD is estimated from Phase 3 of the 1000 Genomes Project and super- and subpopulations can be selected.&lt;/p&gt;
&lt;p&gt;There are different ways to access the LD estimations (e.g. &lt;code&gt;LDpair&lt;/code&gt;, &lt;code&gt;LDmatrix&lt;/code&gt;, &lt;code&gt;LDproxy&lt;/code&gt;) and the same modules are also available through the &lt;a href=&#34;https://ldlink.nci.nih.gov/?tab=help#Programatic%20Access&#34;&gt;API&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To access the API, you need to &lt;a href=&#34;https://ldlink.nci.nih.gov/?tab=apiaccess&#34;&gt;register&lt;/a&gt; for a token (takes a few seconds).&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;MYTOKEN &amp;lt;- &amp;quot;a_mix_of_numbers_and_characters&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let’s look at two modules:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#ldproxy&#34;&gt;LDproxy: access LD between a SNP and its region&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#ldmatrix&#34;&gt;LDmatrix: access LD matrix&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div id=&#34;ldproxy&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;LDproxy&lt;/h3&gt;
&lt;p&gt;To get the LD between a SNP and its region.&lt;/p&gt;
&lt;p&gt;First, access the API:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;LDproxy_raw &amp;lt;- system(
  glue::glue(&amp;quot;curl -k -X GET &amp;#39;https://ldlink.nci.nih.gov/LDlinkRest/ldproxy?var={snp}&amp;amp;pop=EUR&amp;amp;r2_d=r2&amp;amp;token={MYTOKEN}&amp;#39;&amp;quot;),
  intern = TRUE
)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Then, do a bit of data wrangling to get a tidy data frame:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;LDproxy &amp;lt;- LDproxy_raw %&amp;gt;%
  purrr::map(., function(x) stringr::str_split(x, &amp;quot;\t&amp;quot;) %&amp;gt;%
      unlist()) %&amp;gt;% ## remove all the tabs
  do.call(rbind, .) %&amp;gt;% ## turn into a matrix
  data.frame() %&amp;gt;% ## turn into a data frame
  janitor::row_to_names(1) %&amp;gt;% ## make the first row the column names
  rename(SNP = RS_Number) %&amp;gt;% ## rename RS_Number as SNP
  mutate_at(vars(MAF:R2), function(x) as.numeric(as.character(x))) %&amp;gt;% ## turn MAF:R2 columns numeric
  mutate(SNP = as.character(SNP)) ## turn SNP from a factor into a character
head(LDproxy)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##          SNP          Coord Alleles    MAF Distance Dprime     R2
## 1  rs1421085 chr16:53800954   (T/C) 0.4324        0 1.0000 1.0000
## 2 rs11642015 chr16:53802494   (C/T) 0.4324     1540 1.0000 1.0000
## 3 rs62048402 chr16:53803223   (G/A) 0.4324     2269 1.0000 1.0000
## 4  rs1558902 chr16:53803574   (T/A) 0.4324     2620 1.0000 1.0000
## 5 rs55872725 chr16:53809123   (C/T) 0.4324     8169 1.0000 1.0000
## 6 rs56094641 chr16:53806453   (A/G) 0.4344     5499 0.9959 0.9839
##   Correlated_Alleles RegulomeDB Function
## 1            T=T,C=C          5       NA
## 2            T=C,C=T          4       NA
## 3            T=G,C=A          5       NA
## 4            T=T,C=A          7       NA
## 5            T=C,C=T          4       NA
## 6            T=A,C=G          6       NA&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Next, join the original summary stats data with the &lt;code&gt;LDproxy&lt;/code&gt; data frame.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data_ldproxy &amp;lt;- data %&amp;gt;%
  right_join(LDproxy, by = c(&amp;quot;SNP&amp;quot; = &amp;quot;SNP&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Lastly, plot the summary statistics with the point colour indicating the R2.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = data_ldproxy) +
  geom_point(aes(POS, -log10(P), color = R2), shape = 16) +
  labs(
    title = &amp;quot;Locuszoom plot for BMI GWAS&amp;quot;,
    subtitle = paste(
      &amp;quot;Summary statistics for chromosome&amp;quot;, sel.chr, &amp;quot;from&amp;quot;,
      format((sel.pos - range), big.mark = &amp;quot;&amp;#39;&amp;quot;), &amp;quot;to&amp;quot;,
      format((sel.pos + range), big.mark = &amp;quot;&amp;#39;&amp;quot;), &amp;quot;bp&amp;quot;
    ),
    caption = paste(&amp;quot;Data source:&amp;quot;, url)
  ) +
  geom_point(
    data = data_ldproxy %&amp;gt;% filter(SNP == snp),
    aes(POS, -log10(P)), color = &amp;quot;black&amp;quot;, shape = 16
  ) +
  scale_color_distiller(&amp;quot;R2 (LDproxy)&amp;quot;,
    type = &amp;quot;div&amp;quot;, palette = &amp;quot;Spectral&amp;quot;,
    limits = c(0, 1)
  )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://sinarueeger.github.io/post/2018-08-09-put-the-color-into-the-points_files/figure-html/plot-summarystats-ldlink-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;ldmatrix&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;LDmatrix&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;LDmatrix&lt;/code&gt; module accesses the pairwise LD between a set of SNPs.&lt;/p&gt;
&lt;p&gt;Again, first access the API:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;snplist &amp;lt;- data %&amp;gt;%
  filter(str_detect(SNP, &amp;quot;rs&amp;quot;)) %&amp;gt;%
  pull(SNP) %&amp;gt;%
  paste(collapse = &amp;quot;%0A&amp;quot;)

LDmatrix_raw &amp;lt;- system(
  glue::glue(&amp;quot;curl -k -X GET &amp;#39;https://ldlink.nci.nih.gov/LDlinkRest/ldmatrix?snps={snplist}&amp;amp;pop=CEU%2BTSI%2BFIN%2BGBR%2BIBS&amp;amp;r2_d=r2&amp;amp;token={MYTOKEN}&amp;#39;&amp;quot;),
  intern = TRUE
)&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;If you want to access the dprime (d’) values, write &lt;code&gt;r2_d=d&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;If you want to access certain sub populations, let’s say CEU, TSI and FIN, concatenate them with &lt;code&gt;%B&lt;/code&gt; in between: &lt;code&gt;CEU%2BTSI%2BFIN&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Then, do a little data tidying:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;LDmatrix &amp;lt;- LDmatrix_raw %&amp;gt;%
  purrr::map(., function(x) stringr::str_split(x, &amp;quot;\t&amp;quot;) %&amp;gt;%
      unlist()) %&amp;gt;%
  do.call(rbind, .) %&amp;gt;% ## turn into a matrix
  data.frame() %&amp;gt;% ## turn into a data.frame
  janitor::row_to_names(1) ## make the first line the column names

LDmatrix_long &amp;lt;- LDmatrix %&amp;gt;%
  gather(&amp;quot;SNP2&amp;quot;, &amp;quot;R2&amp;quot;, -RS_number) %&amp;gt;% ## from wide to long
  rename(SNP = RS_number) %&amp;gt;% ## rename RS_number
  mutate(R2 = as.numeric(R2)) %&amp;gt;% ## make R2 numeric
  mutate_if(is.factor, as.character) ## make all factor columns characters&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: attributes are not identical across measure variables;
## they will be dropped&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: NAs introduced by coercion&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;head(LDmatrix_long)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##           SNP       SNP2    R2
## 1  rs61754093 rs61754093 1.000
## 2 rs181111349 rs61754093    NA
## 3 rs199662749 rs61754093    NA
## 4 rs189080082 rs61754093 0.000
## 5   rs6499548 rs61754093 0.023
## 6 rs139704369 rs61754093    NA&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Next, join the original summary stats data with the &lt;code&gt;LDmatrix_long&lt;/code&gt; data frame.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data_ldmatrix &amp;lt;- data %&amp;gt;%
  right_join(LDmatrix_long, by = c(&amp;quot;SNP&amp;quot; = &amp;quot;SNP&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Lastly, plot the summary statistics with the point colour indicating the R2.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = data_ldmatrix %&amp;gt;% filter(SNP2 == snp)) +
  geom_point(aes(POS, -log10(P), color = R2)) +
  labs(
    title = &amp;quot;Locuszoom plot for BMI GWAS&amp;quot;,
    subtitle = paste(
      &amp;quot;Summary statistics for chromosome&amp;quot;, sel.chr, &amp;quot;from&amp;quot;,
      format((sel.pos - range), big.mark = &amp;quot;&amp;#39;&amp;quot;), &amp;quot;to&amp;quot;,
      format((sel.pos + range), big.mark = &amp;quot;&amp;#39;&amp;quot;), &amp;quot;bp&amp;quot;
    ),
    caption = paste(&amp;quot;Data source:&amp;quot;, url)
  ) +
  geom_point(
    data = data_ldmatrix %&amp;gt;% filter(SNP == snp &amp;amp; SNP2 == snp),
    aes(POS, -log10(P)), color = &amp;quot;black&amp;quot;, shape = 16
  ) +
  scale_color_distiller(&amp;quot;R2 (LDmatrix)&amp;quot;,
    type = &amp;quot;div&amp;quot;, palette = &amp;quot;Spectral&amp;quot;,
    limits = c(0, 1)
  )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://sinarueeger.github.io/post/2018-08-09-put-the-color-into-the-points_files/figure-html/plot-summarystats-ldlink-matrix-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;!---------- -------------------------------&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;b.-a-solution-that-almost-works-ensembl.org&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;1B. A solution that almost works: ensembl.org&lt;/h2&gt;
&lt;!---------- -------------------------------&gt;
&lt;p&gt;The &lt;a href=&#34;https://rest.ensembl.org&#34;&gt;REST API of Ensembl&lt;/a&gt; can do a lot (see options &lt;a href=&#34;https://rest.ensembl.org/documentation/&#34;&gt;here&lt;/a&gt;). For example access precomputed LD. The webpage even provides R code to do so, which is from where I copied some snippets below.&lt;/p&gt;
&lt;p&gt;To access the rest API at ensembl, we need the following three packages loaded.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(httr)
library(jsonlite)
library(xml2)&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;what-reference-panelspopulation-can-we-choose-from&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;What reference panels/population can we choose from?&lt;/h3&gt;
&lt;!------------------------------&gt;
&lt;p&gt;Currently, the largest and hence most popular public reference panel is &lt;a href=&#34;http://www.internationalgenome.org/&#34;&gt;1000 Genomes reference panel&lt;/a&gt; (1KG). The 26 populations of roughly 100 individuals each can be grouped into five super populations: African (AFR), American (AMR), European (EUR), South Asian (SAS), East Asian (EAS).&lt;/p&gt;
&lt;p&gt;We can ask the ENSEMBL API from what populations reference panels are available. This will return us a data frame.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;server &amp;lt;- &amp;quot;https://rest.ensembl.org&amp;quot;
ext &amp;lt;- &amp;quot;/info/variation/populations/homo_sapiens?filter=LD&amp;quot;

r &amp;lt;- GET(paste(server, ext, sep = &amp;quot;&amp;quot;), content_type(&amp;quot;application/json&amp;quot;))

stop_for_status(r)

head(fromJSON(toJSON(content(r))))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                      name
## 1 1000GENOMES:phase_3:ACB
## 2 1000GENOMES:phase_3:ASW
## 3 1000GENOMES:phase_3:BEB
## 4 1000GENOMES:phase_3:CDX
## 5 1000GENOMES:phase_3:CEU
## 6 1000GENOMES:phase_3:CHB
##                                                  description size
## 1                              African Caribbean in Barbados   96
## 2                           African Ancestry in Southwest US   61
## 3                                      Bengali in Bangladesh   86
## 4                        Chinese Dai in Xishuangbanna, China   93
## 5 Utah residents with Northern and Western European ancestry   99
## 6                               Han Chinese in Bejing, China  103&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;name&lt;/code&gt; stands for the population identifier. &lt;code&gt;size&lt;/code&gt; refers to the number of individuals in the reference panel. Note that these are all populations with around 100 individuals (the correlation estimation will have an error that scales with the sample size). There are also the five super population available (although not listed here), simply replace the last three characters in &lt;code&gt;name&lt;/code&gt; by &lt;code&gt;EUR&lt;/code&gt;, &lt;code&gt;AFR&lt;/code&gt;, &lt;code&gt;AMR&lt;/code&gt;, &lt;code&gt;EAS&lt;/code&gt;, &lt;code&gt;SAS&lt;/code&gt;.&lt;/p&gt;
&lt;iframe seamless src=&#34;https://sinarueeger.github.io/post/2018-08-09-put-the-color-into-the-points/map-1000genomes-populations.html&#34; width=&#34;100%&#34; height=&#34;500&#34;&gt;
&lt;/iframe&gt;
&lt;p&gt;&lt;sup&gt;(From &lt;a href=&#34;../1kgmap.html&#34;&gt;this&lt;/a&gt; blog post.)&lt;/sup&gt;&lt;/p&gt;
&lt;p&gt;We want the LD information, so that we can add this info to the locuszoom plot. But how do we know which population to pick? One way is to read up what kind of individuals were present. In our case - mostly Europeans (&lt;code&gt;EUR&lt;/code&gt;). But we could also build some pooled LD matrix of different populations.&lt;/p&gt;
&lt;p&gt;Now that we know which reference panel we want to use, we can use the different rest APIs.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#access-ld-between-a-snp-and-its-region&#34;&gt;Access LD between a SNP and its region&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#access-ld-matrix&#34;&gt;Access LD matrix&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#access-ld-between-a-snp-and-many-other-snps&#34;&gt;Access LD between a SNP and many other SNPs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;access-ld-between-a-snp-and-its-region&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Access LD between a SNP and its region&lt;/h3&gt;
&lt;!------------------------------&gt;
&lt;p&gt;This API is described &lt;a href=&#34;https://rest.ensembl.org/documentation/info/ld_id_get&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The default window size is 500 kb. There are also thresholds for &lt;code&gt;r2&lt;/code&gt; (e.g. if you want to filter all SNPs with an &lt;code&gt;r2 &amp;gt; 0.8&lt;/code&gt;).&lt;/p&gt;
&lt;p&gt;The only input required is the SNP rsid, marked with &lt;code&gt;{snp}&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;snp&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;rs1421085&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;server &amp;lt;- &amp;quot;https://rest.ensembl.org&amp;quot;
ext &amp;lt;- glue::glue(&amp;quot;/ld/human/{snp}/1000GENOMES:phase_3:EUR?&amp;quot;)
## Window size in kb. The maximum allowed value for the window size is 500 kb. LD is computed for the given variant and all variants that are located within the specified window.

r &amp;lt;- GET(paste(server, ext, sep = &amp;quot;&amp;quot;), content_type(&amp;quot;application/json&amp;quot;))
stop_for_status(r)
LD.SNP.region &amp;lt;- as_tibble(fromJSON(toJSON(content(r)))) %&amp;gt;%
  unnest() %&amp;gt;%
  mutate(r2 = as.numeric(r2))
head(LD.SNP.region)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 6 x 5
##   d_prime  variation1     r2 population_name         variation2 
##   &amp;lt;chr&amp;gt;    &amp;lt;chr&amp;gt;       &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;                   &amp;lt;chr&amp;gt;      
## 1 0.541755 rs1421085  0.0514 1000GENOMES:phase_3:EUR rs1077128  
## 2 0.639310 rs1421085  0.0679 1000GENOMES:phase_3:EUR rs141750185
## 3 0.394345 rs1421085  0.0779 1000GENOMES:phase_3:EUR rs7206010  
## 4 0.393204 rs1421085  0.0765 1000GENOMES:phase_3:EUR rs6499640  
## 5 1.000000 rs1421085  0.953  1000GENOMES:phase_3:EUR rs9928094  
## 6 0.999999 rs1421085  0.922  1000GENOMES:phase_3:EUR rs17817497&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As a result, &lt;code&gt;LD.snp.region&lt;/code&gt; contains the &lt;code&gt;r2&lt;/code&gt; of our top SNP with all SNPs that were +/- 500 kb away.&lt;/p&gt;
&lt;p&gt;What if we want the correlation between all SNPs?&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;access-ld-matrix&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Access LD matrix&lt;/h3&gt;
&lt;!------------------------------&gt;
&lt;p&gt;For this, we need the rest API &lt;a href=&#34;https://rest.ensembl.org/documentation/info/ld_region_get&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;We can calculate the LD matrix of a full region, max 1 Mb wide. For fast computation, we limit it to +/- 50 kb.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Query region. A maximum of 1Mb is allowed.

ext &amp;lt;- glue::glue(&amp;quot;/ld/human/region/{sel.chr}:{sel.pos - range/20}..{sel.pos + range/20}/1000GENOMES:phase_3:EUR?&amp;quot;)

r &amp;lt;- GET(paste(server, ext, sep = &amp;quot;&amp;quot;), content_type(&amp;quot;application/json&amp;quot;))
stop_for_status(r)
LD.matrix.region &amp;lt;- as_tibble(fromJSON(toJSON(content(r)))) %&amp;gt;%
  unnest() %&amp;gt;%
  mutate(r2 = as.numeric(r2))

head(LD.matrix.region)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 6 x 5
##   population_name         variation2      r2 variation1 d_prime 
##   &amp;lt;chr&amp;gt;                   &amp;lt;chr&amp;gt;        &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;      &amp;lt;chr&amp;gt;   
## 1 1000GENOMES:phase_3:EUR rs7190842   0.207  rs56897002 0.999974
## 2 1000GENOMES:phase_3:EUR rs78602287  1      rs74719121 1.000000
## 3 1000GENOMES:phase_3:EUR rs10468280  0.0670 rs58446593 0.999911
## 4 1000GENOMES:phase_3:EUR rs111370419 0.201  rs61325775 0.572122
## 5 1000GENOMES:phase_3:EUR rs62033414  0.106  rs11075991 0.999937
## 6 1000GENOMES:phase_3:EUR rs61325775  0.961  rs9926451  1.000000&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;access-ld-between-a-snp-and-many-other-snps&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Access LD between a SNP and many other SNPs&lt;/h3&gt;
&lt;!------------------------------&gt;
&lt;p&gt;The &lt;a href=&#34;https://rest.ensembl.org/documentation/info/ld_pairwise_get&#34;&gt;third and last option&lt;/a&gt; is to pass on a set of SNP rs ids, and access the LD among these. Implemented in the ENSEMBL API is only the LD between two SNPs, so we will have to extend this to many SNPs.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;extract_ld &amp;lt;- function(SNP.id2 = NULL, SNP.id1 = NULL, POP = NULL) {
  ext &amp;lt;- glue::glue(&amp;quot;/ld/human/pairwise/{SNP.id1}/{SNP.id2}/&amp;quot;) ## filter POP further down

  server &amp;lt;- &amp;quot;https://rest.ensembl.org&amp;quot;

  r &amp;lt;- GET(paste(server, ext, sep = &amp;quot;&amp;quot;), content_type(&amp;quot;application/json&amp;quot;))
  stop_for_status(r)

  out &amp;lt;- as_tibble(fromJSON(toJSON(content(r)))) %&amp;gt;%
    unnest() %&amp;gt;%
    filter(stringr::str_detect(population_name, POP))

  return(out)
}


## see futher down why intersect here
other.snps &amp;lt;- intersect(LD.SNP.region$variation2, data$SNP)

## cacluate LD for all other.snps SNPs
LD.matrix.snps &amp;lt;- purrr::map_df(other.snps, extract_ld, snp, &amp;quot;EUR&amp;quot;) %&amp;gt;%
  mutate(r2 = as.numeric(r2)) %&amp;gt;%
  bind_rows() %&amp;gt;%
  unnest()
LD.matrix.snps&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 0 x 5
## # … with 5 variables: variation1 &amp;lt;chr&amp;gt;, d_prime &amp;lt;chr&amp;gt;, variation2 &amp;lt;chr&amp;gt;,
## #   population_name &amp;lt;chr&amp;gt;, r2 &amp;lt;dbl&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Calculate the LD matrix (&lt;code&gt;LD.matrix.region&lt;/code&gt;) or the LD between SNP pairs (&lt;code&gt;LD.matrix.snps&lt;/code&gt;) takes &lt;em&gt;a lot&lt;/em&gt; of time!&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;coloured-locuszoom-plot&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Coloured locuszoom plot&lt;/h3&gt;
&lt;!---------- -------------------------------&gt;
&lt;p&gt;For the locuszoom plot we need only the correlation between the top SNP and all other SNPs. So we join the object &lt;code&gt;LD.SNP.region&lt;/code&gt; to &lt;code&gt;data&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data_ensembl &amp;lt;- data %&amp;gt;%
  full_join(LD.SNP.region, by = c(&amp;quot;SNP&amp;quot; = &amp;quot;variation2&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ggplot(data = data_ensembl) +
  geom_point(aes(POS, -log10(P), color = r2), shape = 16) +
  labs(
    title = &amp;quot;Locuszoom plot for BMI GWAS&amp;quot;,
    subtitle = paste(&amp;quot;Summary statistics for chromosome&amp;quot;, sel.chr, &amp;quot;from&amp;quot;, format((sel.pos - range), big.mark = &amp;quot;&amp;#39;&amp;quot;), &amp;quot;to&amp;quot;, format((sel.pos + range), big.mark = &amp;quot;&amp;#39;&amp;quot;), &amp;quot;bp&amp;quot;),
    caption = paste(&amp;quot;Data source:&amp;quot;, url)
  ) +
  geom_point(
    data = data_ensembl %&amp;gt;% filter(SNP == &amp;quot;rs1421085&amp;quot;),
    aes(POS, -log10(P)), color = &amp;quot;black&amp;quot;, shape = 16
  ) +
  scale_color_distiller(&amp;quot;R2 (ensembl)&amp;quot;, type = &amp;quot;div&amp;quot;, palette = &amp;quot;Spectral&amp;quot;, limits = c(0, 1))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: Removed 205 rows containing missing values (geom_point).&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://sinarueeger.github.io/post/2018-08-09-put-the-color-into-the-points_files/figure-html/plot-summarystats-ld-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;!-- REST API: https://rviews.rstudio.com/2018/07/23/rest-apis-and-plumber/ -----&gt;
&lt;!---------- -------------------------------&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;solutions-that-work-half-through&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;2. Solutions that work half-through&lt;/h2&gt;
&lt;!---------- -------------------------------&gt;
&lt;div id=&#34;snpsnap&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;SNPsnap&lt;/h3&gt;
&lt;!------------------------------&gt;
&lt;ul&gt;
&lt;li&gt;SNPsnap: &lt;a href=&#34;https://data.broadinstitute.org/mpg/snpsnap/database_download.html&#34; class=&#34;uri&#34;&gt;https://data.broadinstitute.org/mpg/snpsnap/database_download.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;uses a limited set of 1KG populations (EUR, EAS, WAFR).&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;api-provided-by-sph.umich&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;API provided by sph.umich&lt;/h3&gt;
&lt;!------------------------------&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://portaldev.sph.umich.edu/docs/api/v1/?shell#single-variant-statistics&#34;&gt;API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;uses limited set of 1KG populations (ALL, EUR)&lt;/li&gt;
&lt;li&gt;see &lt;a href=&#34;https://github.com/statgen/locuszoom-api/issues/21#issuecomment-414434704&#34;&gt;github issue&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;!---- ### Using locuszoom software -----&gt;
&lt;!------------------------------&gt;
&lt;!---- One option (or rather a hack) would be to use [locuszoom software](https://genome.sph.umich.edu/wiki/LocusZoom_Standalone) to extract their LD information. However, locuszoom comes with database and LD files, [yielding up to 23 G](https://github.com/statgen/locuszoom-standalone). Besides, its not maintained anymore, since a [new version](https://github.com/statgen/locuszoom) for [interactive usage](http://locuszoom.org/locuszoomjs.php) was developed. 

-------&gt;
&lt;!---------- -------------------------------&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;a-solution-that-does-not-work&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;3. A solution that does not work&lt;/h2&gt;
&lt;!---------- -------------------------------&gt;
&lt;div id=&#34;rsnpsld_search&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;code&gt;rsnps::ld_search&lt;/code&gt;&lt;/h3&gt;
&lt;!------------------------------&gt;
&lt;p&gt;A perfect solution would have been the function &lt;code&gt;ld_search&lt;/code&gt; from R package &lt;a href=&#34;ropensci%20webpage&#34;&gt;&lt;code&gt;rsnps&lt;/code&gt;&lt;/a&gt;. It has arguments to choose the reference panel, the population, the distance from the focal SNP.&lt;/p&gt;
&lt;p&gt;The problem is that it only uses old reference panels (HapMap and 1KG-phase1). Meaning, many newer reference panel populations are left out.&lt;/p&gt;
&lt;p&gt;But the main problem is, that the broad institute has taken down the &lt;a href=&#34;https://www.broadinstitute.org/snap/snap&#34;&gt;snap server&lt;/a&gt; that &lt;code&gt;ld_search&lt;/code&gt; used to access (see &lt;a href=&#34;https://github.com/ropensci/rsnps/issues/60&#34;&gt;github issue&lt;/a&gt;); hence &lt;code&gt;ld_search&lt;/code&gt; &lt;a href=&#34;https://github.com/ropensci/rsnps/blob/master/R/LDSearch.R&#34;&gt;is defunct&lt;/a&gt;.&lt;/p&gt;
&lt;!---------- -------------------------------&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;conclusion&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;!---------- -------------------------------&gt;
&lt;p&gt;The
&lt;a href=&#34;https://ldlink.nci.nih.gov/?tab=home&#34;&gt;ldlink&lt;/a&gt; API with the &lt;code&gt;LDproxy&lt;/code&gt; module seems the most perfect solution for now.&lt;/p&gt;
&lt;p&gt;This will probably change with changing technology and larger reference panels.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;session-info&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Session Info&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sessionInfo()&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## R version 3.5.1 (2018-07-02)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS  10.14.5
## 
## Matrix products: default
## BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] janitor_1.2.0     data.table_1.12.2 rsnps_0.3.2.9121 
##  [4] glue_1.3.1.9000   magrittr_1.5      xml2_1.2.0       
##  [7] jsonlite_1.6      httr_1.4.0        forcats_0.4.0    
## [10] stringr_1.4.0     dplyr_0.8.1       purrr_0.3.2      
## [13] readr_1.3.1       tidyr_0.8.3       tibble_2.1.2     
## [16] ggplot2_3.1.1     tidyverse_1.2.1  
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_0.2.5 xfun_0.7         haven_2.1.0      lattice_0.20-38 
##  [5] vctrs_0.1.0      colorspace_1.4-1 generics_0.0.2   htmltools_0.3.6 
##  [9] yaml_2.2.0       utf8_1.1.4       XML_3.98-1.19    rlang_0.3.4     
## [13] pillar_1.4.1     httpcode_0.2.0   withr_2.1.2      modelr_0.1.4    
## [17] readxl_1.3.1     plyr_1.8.4       munsell_0.5.0    blogdown_0.12   
## [21] gtable_0.3.0     cellranger_1.1.0 rvest_0.3.4      evaluate_0.13   
## [25] knitr_1.23       curl_3.3         fansi_0.4.0      triebeard_0.3.0 
## [29] urltools_1.7.3   broom_0.5.2      Rcpp_1.0.1       scales_1.0.0    
## [33] backports_1.1.4  hms_0.4.2        digest_0.6.19    stringi_1.4.3   
## [37] bookdown_0.10    grid_3.5.1       cli_1.1.0        tools_3.5.1     
## [41] lazyeval_0.2.2   crul_0.7.4       zeallot_0.1.0    crayon_1.3.4    
## [45] pkgconfig_2.0.2  lubridate_1.7.4  assertthat_0.2.1 rmarkdown_1.13  
## [49] rstudioapi_0.10  R6_2.4.0         icon_0.1.0       nlme_3.1-140    
## [53] compiler_3.5.1&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Slides</title>
      <link>https://sinarueeger.github.io/slides/example/</link>
      <pubDate>Tue, 05 Feb 2019 00:00:00 +0000</pubDate>
      
      <guid>https://sinarueeger.github.io/slides/example/</guid>
      <description>

&lt;h1 id=&#34;welcome-to-slides&#34;&gt;Welcome to Slides&lt;/h1&gt;

&lt;p&gt;&lt;a href=&#34;https://sourcethemes.com/academic/&#34; target=&#34;_blank&#34;&gt;Academic&lt;/a&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;features&#34;&gt;Features&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Efficiently write slides in Markdown&lt;/li&gt;
&lt;li&gt;3-in-1: Create, Present, and Publish your slides&lt;/li&gt;
&lt;li&gt;Supports speaker notes&lt;/li&gt;
&lt;li&gt;Mobile friendly slides&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;controls&#34;&gt;Controls&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Next: &lt;code&gt;Right Arrow&lt;/code&gt; or &lt;code&gt;Space&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Previous: &lt;code&gt;Left Arrow&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Start: &lt;code&gt;Home&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Finish: &lt;code&gt;End&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Overview: &lt;code&gt;Esc&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Speaker notes: &lt;code&gt;S&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Fullscreen: &lt;code&gt;F&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Zoom: &lt;code&gt;Alt + Click&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/hakimel/reveal.js#pdf-export&#34; target=&#34;_blank&#34;&gt;PDF Export&lt;/a&gt;: &lt;code&gt;E&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;code-highlighting&#34;&gt;Code Highlighting&lt;/h2&gt;

&lt;p&gt;Inline code: &lt;code&gt;variable&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Code block:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;porridge = &amp;quot;blueberry&amp;quot;
if porridge == &amp;quot;blueberry&amp;quot;:
    print(&amp;quot;Eating...&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;math&#34;&gt;Math&lt;/h2&gt;

&lt;p&gt;In-line math: $x + y = z$&lt;/p&gt;

&lt;p&gt;Block math:&lt;/p&gt;

&lt;p&gt;$$
f\left( x \right) = \;\frac{{2\left( {x + 4} \right)\left( {x - 4} \right)}}{{\left( {x + 4} \right)\left( {x + 1} \right)}}
$$&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;fragments&#34;&gt;Fragments&lt;/h2&gt;

&lt;p&gt;Make content appear incrementally&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;{{% fragment %}} One {{% /fragment %}}
{{% fragment %}} **Two** {{% /fragment %}}
{{% fragment %}} Three {{% /fragment %}}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Press &lt;code&gt;Space&lt;/code&gt; to play!&lt;/p&gt;

&lt;p&gt;&lt;span class=&#34;fragment &#34; &gt;
   One
&lt;/span&gt;
&lt;span class=&#34;fragment &#34; &gt;
   &lt;strong&gt;Two&lt;/strong&gt;
&lt;/span&gt;
&lt;span class=&#34;fragment &#34; &gt;
   Three
&lt;/span&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;A fragment can accept two optional parameters:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;class&lt;/code&gt;: use a custom style (requires definition in custom CSS)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;weight&lt;/code&gt;: sets the order in which a fragment appears&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;speaker-notes&#34;&gt;Speaker Notes&lt;/h2&gt;

&lt;p&gt;Add speaker notes to your presentation&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-markdown&#34;&gt;{{% speaker_note %}}
- Only the speaker can read these notes
- Press `S` key to view
{{% /speaker_note %}}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Press the &lt;code&gt;S&lt;/code&gt; key to view the speaker notes!&lt;/p&gt;

&lt;aside class=&#34;notes&#34;&gt;
  &lt;ul&gt;
&lt;li&gt;Only the speaker can read these notes&lt;/li&gt;
&lt;li&gt;Press &lt;code&gt;S&lt;/code&gt; key to view&lt;/li&gt;
&lt;/ul&gt;
&lt;/aside&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;themes&#34;&gt;Themes&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;black: Black background, white text, blue links (default)&lt;/li&gt;
&lt;li&gt;white: White background, black text, blue links&lt;/li&gt;
&lt;li&gt;league: Gray background, white text, blue links&lt;/li&gt;
&lt;li&gt;beige: Beige background, dark text, brown links&lt;/li&gt;
&lt;li&gt;sky: Blue background, thin dark text, blue links&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;ul&gt;
&lt;li&gt;night: Black background, thick white text, orange links&lt;/li&gt;
&lt;li&gt;serif: Cappuccino background, gray text, brown links&lt;/li&gt;
&lt;li&gt;simple: White background, black text, blue links&lt;/li&gt;
&lt;li&gt;solarized: Cream-colored background, dark green text, blue links&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;


&lt;section data-noprocess data-shortcode-slide
  
      
      data-background-image=&#34;/img/boards.jpg&#34;
  &gt;


&lt;h2 id=&#34;custom-slide&#34;&gt;Custom Slide&lt;/h2&gt;

&lt;p&gt;Customize the slide style and background&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-markdown&#34;&gt;{{&amp;lt; slide background-image=&amp;quot;/img/boards.jpg&amp;quot; &amp;gt;}}
{{&amp;lt; slide background-color=&amp;quot;#0000FF&amp;quot; &amp;gt;}}
{{&amp;lt; slide class=&amp;quot;my-style&amp;quot; &amp;gt;}}
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;h2 id=&#34;custom-css-example&#34;&gt;Custom CSS Example&lt;/h2&gt;

&lt;p&gt;Let&amp;rsquo;s make headers navy colored.&lt;/p&gt;

&lt;p&gt;Create &lt;code&gt;assets/css/reveal_custom.css&lt;/code&gt; with:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-css&#34;&gt;.reveal section h1,
.reveal section h2,
.reveal section h3 {
  color: navy;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;hr /&gt;

&lt;h1 id=&#34;questions&#34;&gt;Questions?&lt;/h1&gt;

&lt;p&gt;&lt;a href=&#34;https://discourse.gohugo.io&#34; target=&#34;_blank&#34;&gt;Ask&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://sourcethemes.com/academic/docs/&#34; target=&#34;_blank&#34;&gt;Documentation&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Introduction to Drake</title>
      <link>https://sinarueeger.github.io/talk/r-ladies/</link>
      <pubDate>Mon, 10 Dec 2018 19:00:00 +0100</pubDate>
      
      <guid>https://sinarueeger.github.io/talk/r-ladies/</guid>
      <description>&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;div&gt;
    Click on the &lt;strong&gt;Slides&lt;/strong&gt; button above to view the built-in slides feature.
  &lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Create a map of the 1000 Genomes project reference populations</title>
      <link>https://sinarueeger.github.io/post/1kgmap/</link>
      <pubDate>Wed, 05 Dec 2018 00:00:00 +0000</pubDate>
      
      <guid>https://sinarueeger.github.io/post/1kgmap/</guid>
      <description>
&lt;script src=&#34;https://sinarueeger.github.io/rmarkdown-libs/htmlwidgets/htmlwidgets.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://sinarueeger.github.io/rmarkdown-libs/jquery/jquery.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://sinarueeger.github.io/rmarkdown-libs/leaflet/leaflet.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;https://sinarueeger.github.io/rmarkdown-libs/leaflet/leaflet.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://sinarueeger.github.io/rmarkdown-libs/leafletfix/leafletfix.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;https://sinarueeger.github.io/rmarkdown-libs/Proj4Leaflet/proj4-compressed.js&#34;&gt;&lt;/script&gt;
&lt;script src=&#34;https://sinarueeger.github.io/rmarkdown-libs/Proj4Leaflet/proj4leaflet.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://sinarueeger.github.io/rmarkdown-libs/rstudio_leaflet/rstudio_leaflet.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;https://sinarueeger.github.io/rmarkdown-libs/leaflet-binding/leaflet.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://sinarueeger.github.io/rmarkdown-libs/leaflet-awesomemarkers/leaflet.awesome-markers.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;https://sinarueeger.github.io/rmarkdown-libs/leaflet-awesomemarkers/leaflet.awesome-markers.min.js&#34;&gt;&lt;/script&gt;
&lt;link href=&#34;https://sinarueeger.github.io/rmarkdown-libs/fontawesome/font-awesome.min.css&#34; rel=&#34;stylesheet&#34; /&gt;

&lt;div id=&#34;TOC&#34;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#goal&#34;&gt;Goal&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#get-started&#34;&gt;Get started&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#data&#34;&gt;Data&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#add-geographical-coordinates&#34;&gt;Add geographical coordinates&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#create-leaflet&#34;&gt;Create leaflet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#save-the-map&#34;&gt;Save the map&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reason-for-deviation-from-the-original&#34;&gt;Reason for deviation from the original&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;

&lt;p&gt;This post provides the R-Code to map the 26 populations of the &lt;a href=&#34;http://www.internationalgenome.org/&#34;&gt;1000 Genomes project&lt;/a&gt;.&lt;/p&gt;
&lt;div id=&#34;goal&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Goal&lt;/h2&gt;
&lt;p&gt;Create a map similar to the one&lt;a href=&#34;#fn1&#34; class=&#34;footnote-ref&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt; on the front page of &lt;a href=&#34;http://www.internationalgenome.org/&#34; class=&#34;uri&#34;&gt;http://www.internationalgenome.org/&lt;/a&gt; in a reproducible manner.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;https://sinarueeger.github.io/post/2018-12-05-1000genomes-map/1000genomes-map.png&#34; alt=&#34;Version on internationalgenome.org&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;&lt;em&gt;Version on internationalgenome.org&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;get-started&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Get started&lt;/h2&gt;
&lt;p&gt;Packages needed:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## accessed via ::
# library(mapview)
# library(readxl)
# library(readr)
# library(purrr)
# library(tidyr)
# library(forcats)

library(leaflet) 
library(dplyr) 
library(ggmap) ## for geocode, devtools::install_github(&amp;quot;dkahle/ggmap&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;code&gt;ggmap&lt;/code&gt; requires a google map api key&lt;a href=&#34;#fn2&#34; class=&#34;footnote-ref&#34; id=&#34;fnref2&#34;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt;:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;get one here: &lt;a href=&#34;https://developers.google.com/maps/documentation/geocoding/get-api-key&#34; class=&#34;uri&#34;&gt;https://developers.google.com/maps/documentation/geocoding/get-api-key&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;then run &lt;code&gt;register_google(key = &#34;my_api_key&#34;)&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div id=&#34;data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Data&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;The population counts and labels are from ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20130606_sample_info/ (&lt;a href=&#34;ftp://ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20130606_sample_info/20130606_sample_info.xlsx&#34;&gt;download xlsx file&lt;/a&gt;).&lt;/li&gt;
&lt;li&gt;The super population labels are from &lt;a href=&#34;http://www.internationalgenome.org/faq/which-populations-are-part-your-study/&#34;&gt;here&lt;/a&gt; (pasted into a &lt;a href=&#34;https://sinarueeger.github.io/post/2018-12-05-1000genomes-map/sample_info_superpop.csv&#34;&gt;csv&lt;/a&gt;, then the location was inferred).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Download the population counts and labels first:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;url &amp;lt;-
&amp;quot;ftp.1000genomes.ebi.ac.uk/vol1/ftp/technical/working/20130606_sample_info/20130606_sample_info.xlsx&amp;quot;
url.bitly &amp;lt;- &amp;quot;http://bit.ly/2MQTr02&amp;quot;
download.file(url, &amp;quot;20130606_sample_info.xlsx&amp;quot;, mode = &amp;quot;wb&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Import file into R:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;df &amp;lt;-
  readxl::read_excel(&amp;quot;20130606_sample_info.xlsx&amp;quot;, sheet = &amp;quot;Sample Info&amp;quot;)
  #  &amp;gt;&amp;gt; Sample Info&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Some data wrangling:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## count number of individuals by population
## rename population &amp;gt; POP
n.pop &amp;lt;-
  df %&amp;gt;% 
  group_by(Population) %&amp;gt;% 
  summarise(n = n()) %&amp;gt;% 
  rename(POP = Population)

## import super population names and details to the location of populations
## copied from here:
url.spop &amp;lt;-
  &amp;quot;http://www.internationalgenome.org/faq/which-populations-are-part-your-study/&amp;quot;
## added location manually (!) - found this the only option to prevent overlapping locations. 
## Also, description involves a mix of location and origin.

## rename superpopulation &amp;gt; SPOP
n.spop &amp;lt;-
  readr::read_csv(&amp;quot;../../static/post/2018-12-05-1000genomes-map/sample_info_superpop.csv&amp;quot;) %&amp;gt;% 
  rename(POP = `Population Code`, SPOP = `Super Population Code`)

## join the two information
n.1kg &amp;lt;- left_join(n.pop, n.spop, by = c(&amp;quot;POP&amp;quot; = &amp;quot;POP&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;add-geographical-coordinates&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Add geographical coordinates&lt;/h2&gt;
&lt;p&gt;Parts of the code below is from a map created by &lt;a href=&#34;https://github.com/d4tagirl&#34;&gt;Daniela Vazquez&lt;/a&gt; for R-Ladies: &lt;a href=&#34;https://github.com/rladies/Map-RLadies-Growing&#34; class=&#34;uri&#34;&gt;https://github.com/rladies/Map-RLadies-Growing&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This is the part where we annotate the dataframe &lt;code&gt;n.1kg&lt;/code&gt; with where the individuals live (not their ancestry).
Repeat this until there are no &lt;code&gt;warnings()&lt;/code&gt; about &lt;code&gt;QUERY LIMITS&lt;/code&gt; (the &lt;code&gt;while&lt;/code&gt; loop takes care of this).&lt;/p&gt;
&lt;p&gt;We will use the &lt;code&gt;ggmap&lt;/code&gt; package, which accesses the google maps api.&lt;/p&gt;
&lt;p&gt;A workaround is to set &lt;code&gt;source = &#34;dsk&#34;&lt;/code&gt; (works for a limited number of queries)&lt;a href=&#34;#fn3&#34; class=&#34;footnote-ref&#34; id=&#34;fnref3&#34;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;n.1kg &amp;lt;- n.1kg %&amp;gt;% 
  mutate(purrr::map(.$location, geocode, source = &amp;quot;dsk&amp;quot;)) %&amp;gt;% 
  tidyr::unnest()

## running into the inevitable QUERY LIMITS problems, lets use the approach from https://github.com/rladies/Map-RLadies-Growing
n.1kg.withloc &amp;lt;- n.1kg %&amp;gt;% 
  filter(!is.na(lon))

while(nrow(n.1kg.withloc) != nrow(n.1kg))
{
  #   repeat this until there are no warnings() about QUERY LIMITS
  temp &amp;lt;- n.1kg %&amp;gt;% 
    select(-lon, -lat) %&amp;gt;% 
    anti_join(n.1kg.withloc %&amp;gt;% select(-lon, -lat)) %&amp;gt;% 
    mutate(longlat = purrr::map(.$location, geocode, source = &amp;quot;dsk&amp;quot;)) %&amp;gt;% 
    tidyr::unnest() %&amp;gt;% 
    filter(!is.na(lon))
  
  n.1kg.withloc &amp;lt;- n.1kg.withloc %&amp;gt;% 
    bind_rows(temp) %&amp;gt;% 
    distinct()
}

n.1kg &amp;lt;- n.1kg.withloc

## glue POP and `Population Description` together
n.1kg &amp;lt;-
  n.1kg %&amp;gt;% mutate(pop.desc = paste0(POP, &amp;quot; : &amp;quot;, `Population Description`, &amp;quot; (&amp;quot;, SPOP, &amp;quot;)&amp;quot;))
  
## given that only a number of geolocation are possible with the google API, this 
## should probably stored out
## readr::write_csv(n.1kg, path = &amp;quot;1kg_sample_info_location.csv&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;create-leaflet&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Create leaflet&lt;/h2&gt;
&lt;p&gt;Map locations a world map with leaflet&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## if you have stroed the data in the previous chunk:
## readr::read_csv(&amp;quot;1kg_sample_info_location.csv&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Define shiny icons:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;icons &amp;lt;- awesomeIcons(
  icon = &amp;#39;user&amp;#39;, #people&amp;#39;,
  iconColor = &amp;#39;black&amp;#39;,
  library = &amp;#39;fa&amp;#39;, #ion
  markerColor = as.character(forcats::fct_recode(as.factor(n.1kg$SPOP), 
                                                 red = &amp;quot;EUR&amp;quot;, 
                                                 blue = &amp;quot;AFR&amp;quot;, 
                                                 green = &amp;quot;AMR&amp;quot;, 
                                                 gray = &amp;quot;EAS&amp;quot;, 
                                                 orange = &amp;quot;SAS&amp;quot;)) 
  ## ok, thats not too pretty, but turns out, hex colors won&amp;#39;t work
)

## we need to create a vector that maps cols to SPOP from the markerColor argument above
cols &amp;lt;- c(&amp;quot;#E50102&amp;quot;, &amp;quot;#00A9DD&amp;quot;, &amp;quot;#57BA1F&amp;quot;, &amp;quot;#575757&amp;quot;, &amp;quot;#FD8E00&amp;quot;)
SPOP &amp;lt;- c(&amp;quot;EUR&amp;quot;,  &amp;quot;AFR&amp;quot;, &amp;quot;AMR&amp;quot;, &amp;quot;EAS&amp;quot;, &amp;quot;SAS&amp;quot;)

## separate icon that will display the information
## ------------------------------------------------
icon.info &amp;lt;- awesomeIcons(
  icon = &amp;#39;info&amp;#39;, #people&amp;#39;,
  iconColor = &amp;#39;white&amp;#39;,
  library = &amp;#39;fa&amp;#39;, #ion
  markerColor = &amp;quot;white&amp;quot;
)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create map:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;m &amp;lt;- leaflet(data = n.1kg) %&amp;gt;%
  addTiles() %&amp;gt;%  # Add default OpenStreetMap map tiles
  addAwesomeMarkers(lat=~lat, lng=~lon, label = ~htmltools::htmlEscape(pop.desc), icon = icons) %&amp;gt;% 
  addAwesomeMarkers(lat=-45, lng=-107, popup = glue::glue(&amp;quot;Source: https://github.com/sinarueeger/map-1000genomes&amp;quot;), icon = icon.info) %&amp;gt;% ## this bit has potential to be displayed as a href. 
  #glue::glue(&amp;quot;Source: {url.bitly} + {url.spop} (manual tidying)&amp;quot;), icon = icon.info) %&amp;gt;% 
  addLegend(&amp;quot;bottomright&amp;quot;, 
            colors =cols,
            labels= SPOP,
            opacity = 1)

m  # Print the map&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;htmlwidget-1&#34; style=&#34;width:672px;height:480px;&#34; class=&#34;leaflet html-widget&#34;&gt;&lt;/div&gt;
&lt;script type=&#34;application/json&#34; data-for=&#34;htmlwidget-1&#34;&gt;{&#34;x&#34;:{&#34;options&#34;:{&#34;crs&#34;:{&#34;crsClass&#34;:&#34;L.CRS.EPSG3857&#34;,&#34;code&#34;:null,&#34;proj4def&#34;:null,&#34;projectedBounds&#34;:null,&#34;options&#34;:{}}},&#34;calls&#34;:[{&#34;method&#34;:&#34;addTiles&#34;,&#34;args&#34;:[&#34;//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&#34;,null,null,{&#34;minZoom&#34;:0,&#34;maxZoom&#34;:18,&#34;tileSize&#34;:256,&#34;subdomains&#34;:&#34;abc&#34;,&#34;errorTileUrl&#34;:&#34;&#34;,&#34;tms&#34;:false,&#34;noWrap&#34;:false,&#34;zoomOffset&#34;:0,&#34;zoomReverse&#34;:false,&#34;opacity&#34;:1,&#34;zIndex&#34;:1,&#34;detectRetina&#34;:false,&#34;attribution&#34;:&#34;&amp;copy; &lt;a href=\&#34;http://openstreetmap.org\&#34;&gt;OpenStreetMap&lt;\/a&gt; contributors, &lt;a href=\&#34;http://creativecommons.org/licenses/by-sa/2.0/\&#34;&gt;CC-BY-SA&lt;\/a&gt;&#34;}]},{&#34;method&#34;:&#34;addAwesomeMarkers&#34;,&#34;args&#34;:[[13.16667,34.5003,24,22.08829,40.11995,39.9075,35,4,10,60.16952,50.416667,29.845783,13.5,40,54.75844,35.6895,10.75,0.60751,7.13833,34.05223,-10,31.54972,18.24829,55.9483399,43.41667,7.38778],[-59.53333,-111.50098,90,101.0248,-111.67031,116.39723,105,-72,8,24.93545,-4.75,-96.919704,-15.5,-4,-2.69531,139.69171,106.66667,34.76966,-11.67056,-118.24368,-76,74.34361,-66.49989,-3.1932723,11,3.89639],{&#34;icon&#34;:&#34;user&#34;,&#34;markerColor&#34;:[&#34;blue&#34;,&#34;blue&#34;,&#34;orange&#34;,&#34;gray&#34;,&#34;red&#34;,&#34;gray&#34;,&#34;gray&#34;,&#34;green&#34;,&#34;blue&#34;,&#34;red&#34;,&#34;red&#34;,&#34;orange&#34;,&#34;blue&#34;,&#34;red&#34;,&#34;orange&#34;,&#34;gray&#34;,&#34;gray&#34;,&#34;blue&#34;,&#34;blue&#34;,&#34;green&#34;,&#34;green&#34;,&#34;orange&#34;,&#34;green&#34;,&#34;orange&#34;,&#34;red&#34;,&#34;blue&#34;],&#34;iconColor&#34;:&#34;black&#34;,&#34;spin&#34;:false,&#34;squareMarker&#34;:false,&#34;iconRotate&#34;:0,&#34;font&#34;:&#34;monospace&#34;,&#34;prefix&#34;:&#34;fa&#34;},null,null,{&#34;interactive&#34;:true,&#34;draggable&#34;:false,&#34;keyboard&#34;:true,&#34;title&#34;:&#34;&#34;,&#34;alt&#34;:&#34;&#34;,&#34;zIndexOffset&#34;:0,&#34;opacity&#34;:1,&#34;riseOnHover&#34;:false,&#34;riseOffset&#34;:250},null,null,null,null,[&#34;ACB : African Caribbeans in Barbados (AFR)&#34;,&#34;ASW : Americans of African Ancestry in SW USA (AFR)&#34;,&#34;BEB : Bengali from Bangladesh (SAS)&#34;,&#34;CDX : Chinese Dai in Xishuangbanna, China (EAS)&#34;,&#34;CEU : Utah Residents (CEPH) with Northern and Western European Ancestry (EUR)&#34;,&#34;CHB : Han Chinese in Beijing, China (EAS)&#34;,&#34;CHS : Southern Han Chinese (EAS)&#34;,&#34;CLM : Colombians from Medellin, Colombia (AMR)&#34;,&#34;ESN : Esan in Nigeria (AFR)&#34;,&#34;FIN : Finnish in Finland (EUR)&#34;,&#34;GBR : British in England and Scotland (EUR)&#34;,&#34;GIH : Gujarati Indian from Houston, Texas (SAS)&#34;,&#34;GWD : Gambian in Western Divisions in the Gambia (AFR)&#34;,&#34;IBS : Iberian Population in Spain (EUR)&#34;,&#34;ITU : Indian Telugu from the UK (SAS)&#34;,&#34;JPT : Japanese in Tokyo, Japan (EAS)&#34;,&#34;KHV : Kinh in Ho Chi Minh City, Vietnam (EAS)&#34;,&#34;LWK : Luhya in Webuye, Kenya (AFR)&#34;,&#34;MSL : Mende in Sierra Leone (AFR)&#34;,&#34;MXL : Mexican Ancestry from Los Angeles USA (AMR)&#34;,&#34;PEL : Peruvians from Lima, Peru (AMR)&#34;,&#34;PJL : Punjabi from Lahore, Pakistan (SAS)&#34;,&#34;PUR : Puerto Ricans from Puerto Rico (AMR)&#34;,&#34;STU : Sri Lankan Tamil from the UK (SAS)&#34;,&#34;TSI : Toscani in Italia (EUR)&#34;,&#34;YRI : Yoruba in Ibadan, Nigeria (AFR)&#34;],{&#34;interactive&#34;:false,&#34;permanent&#34;:false,&#34;direction&#34;:&#34;auto&#34;,&#34;opacity&#34;:1,&#34;offset&#34;:[0,0],&#34;textsize&#34;:&#34;10px&#34;,&#34;textOnly&#34;:false,&#34;className&#34;:&#34;&#34;,&#34;sticky&#34;:true},null]},{&#34;method&#34;:&#34;addAwesomeMarkers&#34;,&#34;args&#34;:[-45,-107,{&#34;icon&#34;:&#34;info&#34;,&#34;markerColor&#34;:&#34;white&#34;,&#34;iconColor&#34;:&#34;white&#34;,&#34;spin&#34;:false,&#34;squareMarker&#34;:false,&#34;iconRotate&#34;:0,&#34;font&#34;:&#34;monospace&#34;,&#34;prefix&#34;:&#34;fa&#34;},null,null,{&#34;interactive&#34;:true,&#34;draggable&#34;:false,&#34;keyboard&#34;:true,&#34;title&#34;:&#34;&#34;,&#34;alt&#34;:&#34;&#34;,&#34;zIndexOffset&#34;:0,&#34;opacity&#34;:1,&#34;riseOnHover&#34;:false,&#34;riseOffset&#34;:250},&#34;Source: https://github.com/sinarueeger/map-1000genomes&#34;,null,null,null,null,{&#34;interactive&#34;:false,&#34;permanent&#34;:false,&#34;direction&#34;:&#34;auto&#34;,&#34;opacity&#34;:1,&#34;offset&#34;:[0,0],&#34;textsize&#34;:&#34;10px&#34;,&#34;textOnly&#34;:false,&#34;className&#34;:&#34;&#34;,&#34;sticky&#34;:true},null]},{&#34;method&#34;:&#34;addLegend&#34;,&#34;args&#34;:[{&#34;colors&#34;:[&#34;#E50102&#34;,&#34;#00A9DD&#34;,&#34;#57BA1F&#34;,&#34;#575757&#34;,&#34;#FD8E00&#34;],&#34;labels&#34;:[&#34;EUR&#34;,&#34;AFR&#34;,&#34;AMR&#34;,&#34;EAS&#34;,&#34;SAS&#34;],&#34;na_color&#34;:null,&#34;na_label&#34;:&#34;NA&#34;,&#34;opacity&#34;:1,&#34;position&#34;:&#34;bottomright&#34;,&#34;type&#34;:&#34;unknown&#34;,&#34;title&#34;:null,&#34;extra&#34;:null,&#34;layerId&#34;:null,&#34;className&#34;:&#34;info legend&#34;,&#34;group&#34;:null}]}],&#34;limits&#34;:{&#34;lat&#34;:[-45,60.16952],&#34;lng&#34;:[-118.24368,139.69171]}},&#34;evals&#34;:[],&#34;jsHooks&#34;:[]}&lt;/script&gt;
&lt;/div&gt;
&lt;div id=&#34;save-the-map&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Save the map&lt;/h2&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## save to png
## ------------
mapview::mapshot(m, file = &amp;quot;map-1000genomes-populations.png&amp;quot;)

## save to hmtl
## -------------
htmlwidgets::saveWidget(m, file=&amp;quot;map-1000genomes-populations.html&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;reason-for-deviation-from-the-original&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Reason for deviation from the original&lt;/h2&gt;
&lt;p&gt;I mapped the populations according to the current location but coloured them according to ancestry.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;This is a png and cannot be altered.&lt;a href=&#34;#fnref1&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn2&#34;&gt;&lt;p&gt;Seen here: &lt;a href=&#34;https://stackoverflow.com/questions/36175529/getting-over-query-limit-after-one-request-with-geocode&#34; class=&#34;uri&#34;&gt;https://stackoverflow.com/questions/36175529/getting-over-query-limit-after-one-request-with-geocode&lt;/a&gt;.&lt;a href=&#34;#fnref2&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn3&#34;&gt;&lt;p&gt;See &lt;a href=&#34;https://stackoverflow.com/questions/36175529/getting-over-query-limit-after-one-request-with-geocode&#34; class=&#34;uri&#34;&gt;https://stackoverflow.com/questions/36175529/getting-over-query-limit-after-one-request-with-geocode&lt;/a&gt;.&lt;a href=&#34;#fnref3&#34; class=&#34;footnote-back&#34;&gt;↩&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
