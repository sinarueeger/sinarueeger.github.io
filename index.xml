<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Analysing genetic data</title>
    <link>/</link>
    <description>Recent content on Analysing genetic data</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Sina R&amp;uuml;eger</copyright>
    <lastBuildDate>Mon, 30 Jul 2018 00:00:00 +0000</lastBuildDate>
    
        <atom:link href="/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Locuszoom plot of GWAS summary statistics</title>
      <link>/2018/07/30/locuszoomplot/</link>
      <pubDate>Mon, 30 Jul 2018 00:00:00 +0000</pubDate>
      
      <guid>/2018/07/30/locuszoomplot/</guid>
      <description>&lt;link href=&#34;/rmarkdown-libs/ionicons/css/ionicons.min.css&#34; rel=&#34;stylesheet&#34; /&gt;
&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;!--make a plot, that did not work with knitting--&gt;
&lt;!-- what do we want --&gt;
&lt;p&gt;In the world of &lt;a href=&#34;https://www.acsh.org/news/2018/07/27/genome-wide-association-studies-acsh-explains-13234&#34;&gt;genome-wide association studies&lt;/a&gt; (GWAS) we often get a list of genetic markers (&lt;a href=&#34;https://en.wikipedia.org/wiki/Single-nucleotide_polymorphism&#34;&gt;SNPs&lt;/a&gt;) that seem for some reason relevant for a particular outcome. At the same time, we have little knowledge about these genetic variants that come in cryptic combinations of characters and numbers.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;For example:&lt;/em&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;We might get asked how frequent the SNP &lt;a href=&#34;https://www.ensembl.org/Homo_sapiens/Variation/Explore?r=16:53766542-53767542;v=rs1421085;vdb=variation;vf=984887&#34;&gt;&lt;code&gt;rs1421085&lt;/code&gt;&lt;/a&gt; is in &lt;a href=&#34;https://www.ensembl.org/Homo_sapiens/Variation/Population?r=16:53766542-53767542;v=rs1421085;vdb=variation;vf=984887&#34;&gt;a range of populations.&lt;/a&gt; &lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;We need to extract all known SNPs that are within 1 Mb of &lt;a href=&#34;https://www.ensembl.org/Homo_sapiens/Variation/Explore?r=16:53766542-53767542;v=rs1421085;vdb=variation;vf=984887&#34;&gt;&lt;code&gt;rs1421085&lt;/code&gt;&lt;/a&gt;. &lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;A genomic region turns out to be highly relevant for some disease and we want to know all genes contained in that genomic region.&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Unless you sit on lots of genetic data, the list of SNPs come from a summarised form. Minimally, these summary statistic datasets contain the SNP identifier (&lt;code&gt;SNPNAME&lt;/code&gt;), the effect size (&lt;code&gt;beta&lt;/code&gt;) and the standard error (&lt;code&gt;se&lt;/code&gt;). Sometimes the position (&lt;code&gt;POS&lt;/code&gt;) and chromosome (&lt;code&gt;CHR&lt;/code&gt;) is provided instead of the SNP identifier, and sometimes both are available. Then there is usually other information coming from the study data, for example the allele frequency in the study &lt;i class=&#34;ion  ion-arrow-right-a &#34;&gt;&lt;/i&gt; this is shown on the LHS in table below. However, hardly ever do the datasets contain &lt;font color=&#34;#31a354&#34;&gt;annotation&lt;/font&gt;, such as the &lt;a href=&#34;https://www.cancer.gov/publications/dictionaries/cancer-terms/def/gene&#34;&gt;gene&lt;/a&gt; where the SNP resides, the phenotypes it is associated with or the minor allele frequency (MAF) in a certain population &lt;i class=&#34;ion  ion-arrow-right-a &#34;&gt;&lt;/i&gt; this is illustrated in the &lt;font color=&#34;#31a354&#34;&gt;green&lt;/font&gt; colored part in table below.&lt;/p&gt;
&lt;table class=&#34;table table-striped table&#34; style=&#34;width: auto !important; margin-left: auto; margin-right: auto; font-size: 13px; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; &#34; colspan=&#34;7&#34;&gt;
&lt;div style=&#34;border-bottom: 1px solid #ddd; padding-bottom: 5px;&#34;&gt;
GWAS summary statistics dataset
&lt;/div&gt;
&lt;/th&gt;
&lt;th style=&#34;border-bottom:hidden; padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; &#34; colspan=&#34;3&#34;&gt;
&lt;div style=&#34;border-bottom: 1px solid #ddd; padding-bottom: 5px;&#34;&gt;
Annotation
&lt;/div&gt;
&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
CHR
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
POS
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
SNPNAME
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
REF
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
ALT
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
beta
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
se
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Gene
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Linked phenotype
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Global MAF
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
7
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
75163169
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
rs1167827
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
A
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
G
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.028
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0032
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
HIP1
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
BMI
&lt;/td&gt;
&lt;td style=&#34;text-align:right;color: white;background-color: #31a354;&#34;&gt;
0.4720450
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
12
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
122781897
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
rs11057405
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
G
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
A
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.021
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0037
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
CLIP1
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
BMI
&lt;/td&gt;
&lt;td style=&#34;text-align:right;color: white;background-color: #31a354;&#34;&gt;
0.0327476
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
10
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
114758349
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
rs7903146
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
C
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
T
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.031
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0023
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
TCF7L2
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
BMI
&lt;/td&gt;
&lt;td style=&#34;text-align:right;color: white;background-color: #31a354;&#34;&gt;
0.2278350
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49589847
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
rs657452
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
A
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
G
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0025
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
AGBL4
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
BMI
&lt;/td&gt;
&lt;td style=&#34;text-align:right;color: white;background-color: #31a354;&#34;&gt;
0.4532750
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
49589847
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
rs657452
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
A
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
G
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
-0.015
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
0.0025
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
AC099788.1
&lt;/td&gt;
&lt;td style=&#34;text-align:left;color: white;background-color: #31a354;&#34;&gt;
BMI
&lt;/td&gt;
&lt;td style=&#34;text-align:right;color: white;background-color: #31a354;&#34;&gt;
0.4532750
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;This makes sense. Genetic data from cohorts will be used for years and won‚Äôt change, but the annotation will change over the years. Take the chromosomal position of SNPs, that changes &lt;a href=&#34;https://en.wikipedia.org/wiki/Reference_genome&#34;&gt;with every new human genome reference assembley&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To get our hands on annotation, we need to consult external databases that are - lucky us! - public. But first, let us define what we want to see at the &lt;a href=&#34;#end&#34;&gt;end&lt;/a&gt; of the blogpost.&lt;/p&gt;
&lt;div id=&#34;goal&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Goal&lt;/h2&gt;
&lt;p&gt;For this blogpost, we keep it simple and only focus on the &lt;strong&gt;genes contained in a genomic region&lt;/strong&gt;, but this can be easily extended to any other annotation available in databases.&lt;/p&gt;
&lt;p&gt;In the illustration below&lt;a href=&#34;#fn1&#34; class=&#34;footnoteRef&#34; id=&#34;fnref1&#34;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/a&gt;, we want to know the gene starting and end positions around one particular gene region to create an informative locuszoom plot.&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&#34;/post/annotation/locuszoom-sketch.png&#34; alt=&#34;Drawing of a table.&#34; align=&#34;middle&#34; style=&#34;width: 600px;&#34;/&gt;
&lt;figcaption&gt;
&lt;small&gt;In this case, we want to visualise the GWAS P-value (-log10(P-value)) of a genomic region (with each point representing a SNP), with the corresponding genes at the bottom. This is similar to a plot done with &lt;a href=&#34;http://locuszoom.org/&#34;&gt;LocusZoom&lt;/a&gt;, a tool that takes summary statistics as input and outputs a pretty graph for a desired genomic region, including gene annotation, LD information and more. &lt;/small&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/div&gt;
&lt;div id=&#34;getting-it-done&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Getting it done&lt;/h2&gt;
&lt;!---

&lt;!-- how can we achieve this? --&gt;
&lt;p&gt;There are currently more than 10 Mio SNPs known, and knowing their functions and genes by heart would equal to some super power. Which is why we &lt;i class=&#34;ion  ion-heart &#34;&gt;&lt;/i&gt;&lt;a href=&#34;#fn2&#34; class=&#34;footnoteRef&#34; id=&#34;fnref2&#34;&gt;&lt;sup&gt;2&lt;/sup&gt;&lt;/a&gt; public databases, such as &lt;a href=&#34;https://www.ncbi.nlm.nih.gov/projects/SNP/&#34;&gt;dbSNP&lt;/a&gt; and &lt;a href=&#34;https://www.ensembl.org/index.html&#34;&gt;ensembl&lt;/a&gt;&lt;a href=&#34;#fn3&#34; class=&#34;footnoteRef&#34; id=&#34;fnref3&#34;&gt;&lt;sup&gt;3&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;What we like even more, is, to make our analyses reproducible and automate annotation and lookups.&lt;/p&gt;
&lt;p&gt;&lt;i class=&#34;ion  ion-arrow-right-a &#34;&gt;&lt;/i&gt; In this blogpost, I will show how to zoom into GWAS results and annotate the plot based on the information about that genomic region using R. &lt;!--r icon::ii_r_project().--&gt;&lt;/p&gt;
&lt;!-- why do we need a locus zoom plot anyway ?--&gt;
&lt;p&gt;Here is the plan:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;a href=&#34;#get-summary-statistics&#34;&gt;Get summary statistics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#extracting-annotation&#34;&gt;Extract annotation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#end&#34;&gt;Combine summary statistics and annotation&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Before tackling the first item, we want to have all R-packages installed &amp;amp; ready to use:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Packages needed to run code
## ----------------------------
# install.packages(&amp;quot;dplyr&amp;quot;)     ## data manipulation
# install.packages(&amp;quot;data.table&amp;quot;) ## read data, fast!
# install.packages(&amp;quot;forcats&amp;quot;)   ## dealing with factors
# install.packages(&amp;quot;ggplot2&amp;quot;)   ## dataviz
# install.packages(&amp;quot;magrittr&amp;quot;)  ## piping
# install.packages(&amp;quot;metafolio&amp;quot;)  ## colorpalette
# install.packages(&amp;quot;skimr&amp;quot;)     ## summarising data
# install.packages(&amp;quot;qqman&amp;quot;)     ## Manhattan plot
# install.packages(&amp;quot;patchwork&amp;quot;) ## assembling plots

# source(&amp;quot;https://bioconductor.org/biocLite.R&amp;quot;)
# biocLite(&amp;quot;biomaRt&amp;quot;)           ## annotation

## Optional packages for Rmd
## --------------------------
# install.packages(&amp;quot;kableExtra&amp;quot;) ## making pretty tables
# install.packages(&amp;quot;devtools&amp;quot;)
# devtools::install_github(&amp;quot;hadley/emo&amp;quot;)        ## emojis
# devtools::install_github(&amp;quot;ropenscilabs/icon&amp;quot;) ## icons&lt;/code&gt;&lt;/pre&gt;
&lt;!-- data --&gt;
&lt;/div&gt;
&lt;div id=&#34;get-summary-statistics&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;1. Get summary statistics&lt;/h2&gt;
&lt;p&gt;First, we need some GWAS summary statistics.&lt;/p&gt;
&lt;p&gt;There are lots of &lt;a href=&#34;https://github.com/sinarueeger/statistical-genetics-resources/blob/master/statgen-data.md#gwas-summary-statistic-results&#34;&gt;&lt;strong&gt;resources&lt;/strong&gt;&lt;/a&gt; for publicly available GWAS summary statistics.&lt;/p&gt;
&lt;!-- For example, if you would like to download the latest MDD results, search for *&#39;MDD2 2018&#39;*, for BD and SCZ search for *&#39;BIP and SCZ results from Cell Publication, 2018&#39;*.--&gt;
&lt;p&gt;We will look at BMI, because it can be accessed easily&lt;a href=&#34;#fn4&#34; class=&#34;footnoteRef&#34; id=&#34;fnref4&#34;&gt;&lt;sup&gt;4&lt;/sup&gt;&lt;/a&gt; and because it is fairly small for a genomic dataset. The data is from the &lt;a href=&#34;https://portals.broadinstitute.org/collaboration/giant/index.php/GIANT_consortium_data_files&#34;&gt;Genetic Investigation of ANthropometric Traits&lt;/a&gt; (GIANT) consortium. You can &lt;strong&gt;download&lt;/strong&gt; the dataset&lt;a href=&#34;#fn5&#34; class=&#34;footnoteRef&#34; id=&#34;fnref5&#34;&gt;&lt;sup&gt;5&lt;/sup&gt;&lt;/a&gt; &lt;a href=&#34;https://portals.broadinstitute.org/collaboration/giant/index.php/GIANT_consortium_data_files#GWAMA_Age-.2FSex-Stratified_2015_BMI_and_WHR&#34;&gt;here&lt;/a&gt; or load it &lt;strong&gt;directly into R&lt;/strong&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Data Source URL
url &amp;lt;- &amp;quot;https://portals.broadinstitute.org/collaboration/giant/images/2/21/BMI_All_ancestry.fmt.gzip&amp;quot;

## Import BMI summary statistics dat.bmi &amp;lt;- read_tsv(file = url) ##
## taking too long, let&amp;#39;s use fread instead.

dat.bmi &amp;lt;- data.table::fread(url, verbose = FALSE)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I added &lt;code&gt;verbose = FALSE&lt;/code&gt; because it will complain that there is an unexpected character in column 1, which appears to be numerical. This is because chromosome X will only appear towards the end of the dataset.&lt;/p&gt;
&lt;p&gt;Next, we rename some columns to something more conventional.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Rename some columns
dat.bmi &amp;lt;- dat.bmi %&amp;gt;% rename(SNP = SNPNAME, P = Pvalue)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now, let‚Äôs look at the data with the &lt;a href=&#34;https://github.com/ropensci/skimr&#34;&gt;&lt;code&gt;skimr&lt;/code&gt;&lt;/a&gt; package.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;skimr::skim(dat.bmi)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Skim summary statistics
##  n obs: 246328 
##  n variables: 10 
## 
## ‚îÄ‚îÄ Variable type:character ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
##  variable missing complete      n min max empty n_unique
##       ALT       0   246328 246328   1   1     0        4
##       CHR       0   246328 246328   1   2     0       23
##  ExAC_MAF       0   246328 246328   1 325     0    51423
##      GMAF       0   246328 246328   1  17     0     9964
##       REF       0   246328 246328   1   1     0        4
##       SNP       0   246328 246328   1  11     0   243206
## 
## ‚îÄ‚îÄ Variable type:integer ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
##  variable missing complete      n    mean      sd    p0     p25     p50
##       POS       0   246328 246328 7.6e+07 5.7e+07 11885 3.2e+07 6.1e+07
##      p75    p100     hist
##  1.1e+08 2.5e+08 ‚ñá‚ñá‚ñÖ‚ñÖ‚ñÉ‚ñÇ‚ñÅ‚ñÅ
## 
## ‚îÄ‚îÄ Variable type:numeric ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
##  variable missing complete      n      mean     sd        p0    p25
##      beta     977   245351 246328   0.00051   0.13 -3.2      -0.032
##         P     977   245351 246328   0.48      0.3   8.6e-269  0.21 
##        se       0   246328 246328 Inf       NaN     0.002     0.023
##       p50   p75  p100     hist
##  -0.00017 0.031   3.2 ‚ñÅ‚ñÅ‚ñÅ‚ñá‚ñá‚ñÅ‚ñÅ‚ñÅ
##   0.47    0.73    1   ‚ñá‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ
##   0.059   0.11  Inf   ‚ñá‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ‚ñÅ&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The reference allele (&lt;code&gt;REF&lt;/code&gt;), alternative allele (&lt;code&gt;ALT&lt;/code&gt;), SNP identifier (&lt;code&gt;SNP&lt;/code&gt;) and chromosome (&lt;code&gt;CHR&lt;/code&gt;) are characters. There are four unique values for &lt;code&gt;ALT&lt;/code&gt; and &lt;code&gt;REF&lt;/code&gt;: A, C, G, T, and 23 unique values for &lt;code&gt;CHR&lt;/code&gt; - seems about right. The two columns with the minor allele frequencies measured in &lt;a href=&#34;https://portals.broadinstitute.org/collaboration/giant/index.php/Main_Page&#34;&gt;GIANT&lt;/a&gt; and &lt;a href=&#34;http://exac.broadinstitute.org/&#34;&gt;ExAC&lt;/a&gt; datasets (&lt;code&gt;GMAF&lt;/code&gt;, &lt;code&gt;ExAC_MAF&lt;/code&gt;) are characters too, because the allele is concatenated. The chromosomal position (&lt;code&gt;POS&lt;/code&gt;) is an integer. Then there is the actual association of each SNP with BMI (&lt;code&gt;beta&lt;/code&gt;, &lt;code&gt;se&lt;/code&gt;, &lt;code&gt;P&lt;/code&gt;).&lt;/p&gt;
&lt;!-- The first column indicates the chromosome (`CHR`), the second the chromosomal position (`POS`), then the reference allele (`REF`), the alternative allele (`ALT`), the SNP identifier (`SNP`), minor allele frequencies measured in [GIANT](https://portals.broadinstitute.org/collaboration/giant/index.php/Main_Page) and [ExAC](http://exac.broadinstitute.org/) datasets (`GMAF`, `ExAC_MAF`), followed by the association of that SNP with BMI (`beta`, `se`, `P`). --&gt;
&lt;p&gt;This dataset has 246328 rows and 10 columns. What if we want to visualise this all at once? In particularly, we are interested if there are ANY associations between the genetic markers and BMI. The mini &lt;code&gt;P&lt;/code&gt; distribution in the skimr output does not reveal much.&lt;/p&gt;
&lt;div id=&#34;visualising-associations&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Visualising associations&lt;/h3&gt;
&lt;p&gt;Visualising all associations at once can be done with a Manhattan plot, where the x-axis represents chromosome&lt;code&gt;CHR&lt;/code&gt; and the chromosomal position &lt;code&gt;POS&lt;/code&gt;, and the y-axis the &lt;code&gt;-log10(P)&lt;/code&gt;-value. Let‚Äôs use the R-package &lt;code&gt;qqman&lt;/code&gt;&lt;a href=&#34;#fn6&#34; class=&#34;footnoteRef&#34; id=&#34;fnref6&#34;&gt;&lt;sup&gt;6&lt;/sup&gt;&lt;/a&gt; for that.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;qqman::manhattan(dat.bmi %&amp;gt;% mutate(CHR = as.numeric(as.character(fct_recode(CHR, &amp;quot;23&amp;quot; = &amp;quot;X&amp;quot;)))) %&amp;gt;%   filter(-log10(P)&amp;gt;1), chr=&amp;quot;CHR&amp;quot;, bp=&amp;quot;POS&amp;quot;, snp=&amp;quot;SNP&amp;quot;, p=&amp;quot;P&amp;quot;, suggestiveline =FALSE, genomewideline = FALSE, chrlabs = c(1:22, &amp;quot;X&amp;quot;), cex = 0.4)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-07-04-plotting-local-genomic-association-results-in-r_files/figure-html/mhtplot-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We can spot immediately, that there are loads of SNPs with P-values smaller than &lt;span class=&#34;math inline&#34;&gt;\(10^{-100}\)&lt;/span&gt; (sample size was around &lt;a href=&#34;https://www.biorxiv.org/content/early/2018/03/22/274654&#34;&gt;700K&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Of course, there are many other solutions to spot real associations, but this is not the point of this blogpost ;-).&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;identify-genomic-region-with-lowest-p-value&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Identify genomic region with lowest P-value&lt;/h3&gt;
&lt;p&gt;Now that we know that there are lots of genetic markers associated with BMI, we want to look at a specific genomic region and figure out what genes it contains. For illustrative purposes, we pick the genomic region with the lowest P-value.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;dat.bmi.sel &amp;lt;- dat.bmi %&amp;gt;% slice(which.min(P))
dat.bmi.sel&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##    CHR      POS REF ALT       SNP     GMAF ExAC_MAF  beta     se        P
## 1:  16 53800954   T   C rs1421085 C:0.2286        - 0.078 0.0022 8.6e-269&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;SNP identifier rs1421085 that has the lowest P-value (&lt;span class=&#34;math inline&#34;&gt;\(P = 8.6\times 10^{-269}\)&lt;/span&gt;).&lt;/p&gt;
&lt;p&gt;Now we can visualise the summary statistics of that genomic region (&lt;span class=&#34;math inline&#34;&gt;\(\pm 500 \cdot 10^{3}\)&lt;/span&gt;).&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;range &amp;lt;- 5e+05
sel.chr &amp;lt;- dat.bmi.sel$CHR
sel.pos &amp;lt;- dat.bmi.sel$POS

dat.bmi.sel.region &amp;lt;- dat.bmi %&amp;gt;% filter(CHR == sel.chr, between(POS, sel.pos - 
      range, sel.pos + range))&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;p1 &amp;lt;- ggplot(data = dat.bmi.sel.region) + 
  geom_point(aes(POS, -log10(P)), shape = 1) + 
  labs(title = &amp;quot;Locuszoomplot for BMI GWAS&amp;quot;, subtitle = paste(&amp;quot;Summary   statistics for chromosome&amp;quot;, sel.chr, &amp;quot;from&amp;quot;, format((sel.pos - range), big.mark = &amp;quot;&amp;#39;&amp;quot;), &amp;quot;to&amp;quot;, format((sel.pos + range), big.mark = &amp;quot;&amp;#39;&amp;quot;), &amp;quot;bp&amp;quot;), caption = paste(&amp;quot;Data source:&amp;quot;, url))
print(p1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-07-04-plotting-local-genomic-association-results-in-r_files/figure-html/plot-summarystats-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Next, we want to know if rs1421085 is part of a gene, and if yes, which one.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;extracting-annotation&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;2. Extracting annotation&lt;/h2&gt;
&lt;div id=&#34;biomart&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;biomaRt&lt;/h3&gt;
&lt;p&gt;Thankfully, there is an R-package called &lt;a href=&#34;https://bioconductor.org/packages/release/bioc/html/biomaRt.html&#34;&gt;&lt;code&gt;biomaRt&lt;/code&gt;&lt;/a&gt; that can do this for us.&lt;/p&gt;
&lt;p&gt;I have only come across this package a few weeks ago, so I apologise in advance that I won‚Äôt make full use of all the features that the package offers.&lt;/p&gt;
&lt;p&gt;&lt;i class=&#34;ion  ion-alert &#34;&gt;&lt;/i&gt; &lt;code&gt;biomaRt&lt;/code&gt; should not to be confused with &lt;a href=&#34;https://github.com/ropensci/biomartr&#34;&gt;&lt;code&gt;biomartr&lt;/code&gt;&lt;/a&gt;. &lt;code&gt;biomartr&lt;/code&gt; is an rOpenSci package by &lt;a href=&#34;https://twitter.com/HajkDrost&#34;&gt;Hajk-Georg Drost&lt;/a&gt;. I needed this tweet &lt;i class=&#34;ion  ion-arrow-down-a &#34;&gt;&lt;/i&gt; to realise that these were two separate, yet related R-packages.&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34; data-lang=&#34;en&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
Did you ever want to reproducibly retrieve thousands of genomes across the tree of life using only one R command? Then have a look at the new version of biomartr which is on its way to CRAN! &lt;a href=&#34;https://t.co/kWF5XCoGhj&#34;&gt;https://t.co/kWF5XCoGhj&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/bioinformatics?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#bioinformatics&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/rstats?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#rstats&lt;/a&gt; &lt;a href=&#34;https://twitter.com/hashtag/Genomics?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#Genomics&lt;/a&gt; &lt;a href=&#34;https://t.co/EZHJP0n1f9&#34;&gt;pic.twitter.com/EZHJP0n1f9&lt;/a&gt;
&lt;/p&gt;
‚Äî Hajk-Georg Drost (&lt;span class=&#34;citation&#34;&gt;@HajkDrost&lt;/span&gt;) &lt;a href=&#34;https://twitter.com/HajkDrost/status/1012280903488466945?ref_src=twsrc%5Etfw&#34;&gt;June 28, 2018&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;
&lt;p&gt;So far, I did not fully grasp the benefits of &lt;code&gt;biomartr&lt;/code&gt; compared to &lt;code&gt;biomaRt&lt;/code&gt; for annotation of human data. But I will definitely &lt;a href=&#34;https://ropensci.github.io/biomartr/articles/Functional_Annotation.html&#34;&gt;look more into it&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I also got a tip from &lt;a href=&#34;https://twitter.com/MariannaFoos&#34;&gt;Marianna Foos&lt;/a&gt; to check out &lt;a href=&#34;https://cran.r-project.org/web/packages/rsnps/vignettes/rsnps_vignette.html&#34;&gt;&lt;code&gt;rsnps&lt;/code&gt;&lt;/a&gt;, an R-package dealing with SNP annotation.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;learning-resources&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Learning resources&lt;/h3&gt;
&lt;p&gt;I used mainly two sources to learn what I wanted to do:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.bioconductor.org/packages/devel/bioc/vignettes/biomaRt/inst/doc/biomaRt.html&#34;&gt;Vignette of biomaRt&lt;/a&gt; on Bioconductor&lt;a href=&#34;#fn7&#34; class=&#34;footnoteRef&#34; id=&#34;fnref7&#34;&gt;&lt;sup&gt;7&lt;/sup&gt;&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://stackoverflow.com/questions/41490657/best-way-to-get-list-of-snps-by-gene-id&#34;&gt;This question&lt;/a&gt; on StackOverflow.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;using-biomart&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Using biomaRt&lt;/h3&gt;
&lt;p&gt;First, we need to load the &lt;code&gt;biomaRt&lt;/code&gt; &lt;a href=&#34;https://bioconductor.org/packages/release/bioc/html/biomaRt.html&#34;&gt;package from Bioconductor&lt;/a&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(biomaRt) &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Next we specify which database to use. You can use the functions &lt;code&gt;listMart()&lt;/code&gt;, &lt;code&gt;listEnsembl()&lt;/code&gt; and &lt;code&gt;listDatasets()&lt;/code&gt; to select from the right biomart and dataset. We will need to extract SNPs, hence &lt;code&gt;biomart = &amp;quot;snp&amp;quot;&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;snp.ensembl &amp;lt;- useEnsembl(biomart = &amp;quot;snp&amp;quot;, dataset = &amp;quot;hsapiens_snp&amp;quot;)

class(snp.ensembl)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;Mart&amp;quot;
## attr(,&amp;quot;package&amp;quot;)
## [1] &amp;quot;biomaRt&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# other ways of selecting the mart snp.mart &amp;lt;- useMart(biomart =
# &amp;#39;ENSEMBL_MART_SNP&amp;#39;, dataset=&amp;#39;hsapiens_snp&amp;#39;) 
# gene.mart &amp;lt;- useMart(&amp;#39;ensembl&amp;#39;, dataset=&amp;#39;hsapiens_gene_ensembl&amp;#39;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Last, we extract the gene id to which our SNP belongs using the function &lt;code&gt;getBM()&lt;/code&gt;. Along with that we also extract other information, like the minor allele frequency &lt;code&gt;minor_allele_freq&lt;/code&gt;. To check which attributes and filters are available, run &lt;code&gt;listAttributes(snp.ensembl)&lt;/code&gt; and &lt;code&gt;listFilters(snp.ensembl)&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;out.bm &amp;lt;- getBM(
  attributes = c(&amp;quot;ensembl_gene_stable_id&amp;quot;, 
                 &amp;quot;refsnp_id&amp;quot;, 
                 &amp;quot;chr_name&amp;quot;, 
                 &amp;quot;chrom_start&amp;quot;, 
                 &amp;quot;chrom_end&amp;quot;, 
                 &amp;quot;minor_allele&amp;quot;, 
                 &amp;quot;minor_allele_freq&amp;quot;),
  filters = &amp;quot;snp_filter&amp;quot;, 
  values = dat.bmi.sel$SNP, 
  mart = snp.ensembl)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This gives us - as chosen in &lt;code&gt;attributes&lt;/code&gt; - the gene identifier, the SNP identifier, the chromosome name, chromosomal position (start + end), minor allele and minor allele frequency. The output in &lt;code&gt;out.bm&lt;/code&gt; corresponds to &lt;a href=&#34;https://www.ensembl.org/Homo_sapiens/Variation/Explore?r=16:53766542-53767542;v=rs1421085;vdb=variation;vf=984887&#34;&gt;this&lt;/a&gt; webpage entry on the ensembl webpage.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;out.bm&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   ensembl_gene_stable_id refsnp_id chr_name chrom_start chrom_end
## 1        ENSG00000140718 rs1421085       16    53767042  53767042
##   minor_allele minor_allele_freq
## 1            C          0.228634&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;quick-d-tour-assembly-grch37-or-grch38&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Quick d-tour: assembly GRCh37 or GRCh38?&lt;/h3&gt;
&lt;p&gt;Before getting the gene names, we want to check if the position in the dataset are from assembly GRCh37 or GRCh38. This is a handy thing, because oftentimes only SNP identifiers are reported. Or SNP identifiers are reported, but with positions on a &lt;a href=&#34;https://en.wikipedia.org/wiki/Reference_genome&#34;&gt;different assembly&lt;/a&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ifelse(sel.pos == out.bm$chrom_start, 
       &amp;quot;\u2713: same assembley (GRCh38)&amp;quot;, 
       &amp;quot;\u2717: not the same assembley&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;‚úó: not the same assembley&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The position is not matching, because the databases that we are looking at is based on the most recent &lt;code&gt;human assembly GRCh38&lt;/code&gt;, but the BMI summary statistics dataset is based on &lt;a href=&#34;https://grch37.ensembl.org/index.html&#34;&gt;&lt;code&gt;human assembly GRCh37&lt;/code&gt;&lt;/a&gt;. The command &lt;code&gt;listEnsemblArchives()&lt;/code&gt; will list you the URLs needed to get access to an archived assembly. So let‚Äôs pull out the archived GRCh37 version with the argument &lt;code&gt;host = &#39;http://grch37.ensembl.org&#39;&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;snp.ensembl.grch37 &amp;lt;- useMart(host=&amp;#39;http://grch37.ensembl.org&amp;#39;, 
                     biomart=&amp;#39;ENSEMBL_MART_SNP&amp;#39;, 
                     dataset=&amp;#39;hsapiens_snp&amp;#39;)

out.bm.grch37 &amp;lt;- getBM(
  attributes = c(&amp;#39;ensembl_gene_stable_id&amp;#39;, &amp;#39;refsnp_id&amp;#39;, &amp;#39;chr_name&amp;#39;, &amp;#39;chrom_start&amp;#39;, &amp;#39;chrom_end&amp;#39;, &amp;#39;minor_allele&amp;#39;, &amp;#39;minor_allele_freq&amp;#39;),
  filters = &amp;#39;snp_filter&amp;#39;,
  values = dat.bmi.sel$SNP,
  mart = snp.ensembl.grch37
)
out.bm.grch37&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   ensembl_gene_stable_id refsnp_id chr_name chrom_start chrom_end
## 1        ENSG00000140718 rs1421085       16    53800954  53800954
##   minor_allele minor_allele_freq
## 1            C          0.228634&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let‚Äôs check again.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ifelse(sel.pos == out.bm.grch37$chrom_start,
       &amp;quot;\u2713: same assembley (grch37)&amp;quot;, 
       &amp;quot;\u2717: not the same assembley&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;‚úì: same assembley (grch37)&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;https://twitter.com/flaviahodel&#34;&gt;Flavia Hodel&lt;/a&gt; pointed out that adding the argument &lt;code&gt;GRCh = 37&lt;/code&gt; works too! That‚Äôs handy argument (but limited to GRCh versions 37 and 38).&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;snp.ensembl.grch37.alt &amp;lt;- useEnsembl(biomart = &amp;quot;snp&amp;quot;, dataset = &amp;quot;hsapiens_snp&amp;quot;, GRCh = 37)


out.bm.grch37 &amp;lt;- getBM(
  attributes = c(&amp;#39;ensembl_gene_stable_id&amp;#39;, &amp;#39;refsnp_id&amp;#39;, &amp;#39;chr_name&amp;#39;, &amp;#39;chrom_start&amp;#39;, &amp;#39;chrom_end&amp;#39;, &amp;#39;minor_allele&amp;#39;, &amp;#39;minor_allele_freq&amp;#39;),
  filters = &amp;#39;snp_filter&amp;#39;,
  values = dat.bmi.sel$SNP,
  mart = snp.ensembl.grch37.alt
)
out.bm.grch37&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   ensembl_gene_stable_id refsnp_id chr_name chrom_start chrom_end
## 1        ENSG00000140718 rs1421085       16    53800954  53800954
##   minor_allele minor_allele_freq
## 1            C          0.228634&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;ifelse(sel.pos == out.bm.grch37$chrom_start,
       &amp;quot;\u2713: same assembley (grch37)&amp;quot;, 
       &amp;quot;\u2717: not the same assembley&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] &amp;quot;‚úì: same assembley (grch37)&amp;quot;&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;extracting-gene-name-for-one-snp&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Extracting gene name for one SNP&lt;/h3&gt;
&lt;p&gt;Next, we want to get the gene name where rs1421085 falls into.&lt;/p&gt;
&lt;p&gt;Let‚Äôs check which &lt;code&gt;attributes&lt;/code&gt; contain the string &lt;code&gt;gene&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;listAttributes(snp.ensembl) %&amp;gt;% slice(str_which(name, &amp;quot;gene&amp;quot;)) &lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##                     name                    description page
## 1        associated_gene Associated gene with phenotype  snp
## 2 ensembl_gene_stable_id                 Gene stable ID  snp&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now use &lt;code&gt;ensembl_gene_stable_id&lt;/code&gt; and &lt;code&gt;associated_gene&lt;/code&gt; as additional attributes.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## extract gene
## ----------
out.bm.snp2gene &amp;lt;- getBM(
  attributes = c(&amp;#39;refsnp_id&amp;#39;, &amp;#39;allele&amp;#39;, &amp;#39;chrom_start&amp;#39;, &amp;#39;chr_name&amp;#39;, &amp;#39;ensembl_gene_stable_id&amp;#39;), 
      filters = c(&amp;#39;snp_filter&amp;#39;), 
      values = dat.bmi.sel$SNP, 
      mart = snp.ensembl)
out.bm.snp2gene&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   refsnp_id allele chrom_start chr_name ensembl_gene_stable_id
## 1 rs1421085    T/C    53767042       16        ENSG00000140718&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Attribute `associated_gene` is `Associated gene with phenotype`.

## Extract string
## ----------
gene.ensembl &amp;lt;- useEnsembl(biomart = &amp;quot;ensembl&amp;quot;, dataset = &amp;quot;hsapiens_gene_ensembl&amp;quot;, GRCh = 37) # we will need an additional mart for genes
## because we are using positions from GRCh = 37 in a next query, we need to pass that information on.
out.bm.gene &amp;lt;- getBM(attributes = c(&amp;#39;external_gene_name&amp;#39;), 
      filters = c(&amp;#39;ensembl_gene_id&amp;#39;),
      values = unique(out.bm.snp2gene$ensembl_gene_stable_id), 
      mart = gene.ensembl)
out.bm.gene&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   external_gene_name
## 1                FTO&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The gene that contains SNP rs1421085 is called FTO.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;extracting-gene-names-for-genomic-region&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Extracting gene names for genomic region&lt;/h3&gt;
&lt;p&gt;So now we know that rs1421085 is part of FTO. But where does FTO start and end? And what are the genes nearby? For this purpose, we want to visualise the summary statistics of the full genomic region (&lt;span class=&#34;math inline&#34;&gt;\(\pm 250 \cdot 10^3\)&lt;/span&gt; Mb). We just recycle the previous code, but instead of providing a SNP-id, we provide the chromosome, the start and the end position.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;out.bm.genes.region &amp;lt;- getBM(
  attributes = c(&amp;#39;start_position&amp;#39;,&amp;#39;end_position&amp;#39;,&amp;#39;ensembl_gene_id&amp;#39;,&amp;#39;external_gene_name&amp;#39;, &amp;#39;gene_biotype&amp;#39;), 
      filters = c(&amp;#39;chromosome_name&amp;#39;,&amp;#39;start&amp;#39;,&amp;#39;end&amp;#39;), 
      values = list(sel.chr, sel.pos - range, sel.pos + range), 
      mart = gene.ensembl)
head(out.bm.genes.region)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   start_position end_position ensembl_gene_id external_gene_name
## 1       53088945     53363062 ENSG00000177200               CHD9
## 2       53332136     53333704 ENSG00000261056       RP11-454F8.2
## 3       53368474     53368576 ENSG00000238645             snoU13
## 4       53371365     53371483 ENSG00000202193          RNA5SP427
## 5       53395931     53397590 ENSG00000259962       RP11-44F14.4
## 6       53398894     53406995 ENSG00000260078       RP11-44F14.1
##     gene_biotype
## 1 protein_coding
## 2     pseudogene
## 3         snoRNA
## 4           rRNA
## 5     pseudogene
## 6     pseudogene&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can plot &lt;code&gt;out.bm.genes.region&lt;/code&gt; with a linerange plot, where each horizontal line represents one gene.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## rank gene names according to start position
out.bm.genes.region &amp;lt;- out.bm.genes.region %&amp;gt;% mutate(external_gene_name = fct_reorder(external_gene_name, 
      start_position, .desc = TRUE))

## plot
ggplot(data = out.bm.genes.region) + 
      geom_linerange(aes(x = external_gene_name, ymin = start_position, ymax = end_position)) + 
  coord_flip() + 
  ylab(&amp;quot;&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-07-04-plotting-local-genomic-association-results-in-r_files/figure-html/plot-genes-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Let‚Äôs try to make that pretty. We can group the genes by &lt;code&gt;gene_biotype&lt;/code&gt; and colour them accordingly. And we move the protein-coding genes to the top row and color it black.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## define plot range for x-axis
plot.range &amp;lt;- c(min(sel.pos - range, out.bm.genes.region$start_position), 
      max(sel.pos + range, out.bm.genes.region$end_position))

## rank gene_biotype label
out.bm.genes.region &amp;lt;- out.bm.genes.region %&amp;gt;% mutate(gene_biotype_fac = fct_relevel(as.factor(gene_biotype), 
      &amp;quot;protein_coding&amp;quot;), external_gene_name = fct_reorder2(external_gene_name, 
      start_position, gene_biotype_fac, .desc = TRUE))


## plot
p2 &amp;lt;- ggplot(data = out.bm.genes.region) + 
  geom_linerange(aes(x = external_gene_name, ymin = start_position, ymax = end_position, colour = gene_biotype_fac, group = gene_biotype_fac)) +
  coord_flip() + ylab(&amp;quot;&amp;quot;) +
  ylim(plot.range) + 
  geom_text(aes(x = external_gene_name, y = start_position, label = external_gene_name, colour = gene_biotype_fac), fontface = 2, alpha = I(0.7), hjust = &amp;quot;right&amp;quot;, size= 2.5) + 
  labs(title = &amp;quot;&amp;quot;, subtitle = paste0(&amp;quot;Genes&amp;quot;), caption = paste0(&amp;quot;Data source: &amp;quot;, gene.ensembl@host, &amp;quot; + Data set: &amp;quot;, gene.ensembl@dataset), color = &amp;quot;Gene Biotype&amp;quot;) +
  theme(axis.title.y=element_blank(),
        axis.text.y=element_blank(),
        axis.ticks.y=element_blank(), 
        strip.text.y = element_text(angle = 0),
        legend.position=&amp;quot;bottom&amp;quot;, 
        panel.grid.major.y = element_blank()) + 
  expand_limits(y=c(-1, 1)) +
  scale_color_manual(values = c(&amp;quot;black&amp;quot;, metafolio::gg_color_hue(nlevels(out.bm.genes.region$gene_biotype_fac)-1)))
  ## hack to have 11 colors, but probably merging some gene biotype groups could make sense too. 
  ## consider colorblindr::palette_OkabeIto_black
print(p2)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-07-04-plotting-local-genomic-association-results-in-r_files/figure-html/plot-genes-pretty-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;There are some short genes starting with &lt;em&gt;AC&lt;/em&gt; and &lt;em&gt;LINCO&lt;/em&gt;. We can &lt;a href=&#34;https://www.genenames.org/about/guidelines&#34;&gt;check&lt;/a&gt; what they are and/or consult a biologist.&lt;/p&gt;
&lt;!-- GWAS + biomart info --&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;end&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;3. Combining summary statistics and annotation&lt;/h2&gt;
&lt;p&gt;Now we are ready to combine plot &lt;code&gt;p1&lt;/code&gt; and &lt;code&gt;p2&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(patchwork)

p1b &amp;lt;- p1 + xlab(&amp;quot;&amp;quot;) + theme(axis.title.x=element_blank(), axis.text.x=element_blank(), axis.ticks.x=element_blank()) + xlim(plot.range)

p1b + p2 + plot_layout(ncol = 1, heights = c(6, 6))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-07-04-plotting-local-genomic-association-results-in-r_files/figure-html/summarystats-genes-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Having both plots combined, we can spot that the are 6 protein-coding genes in the region. But the P-value peak is located in gene FTO.&lt;/p&gt;
&lt;p&gt;If this were work done for a real project, this would now be the time to get back to domain experts, discuss the results and figure out what other annotation they need&lt;a href=&#34;#fn8&#34; class=&#34;footnoteRef&#34; id=&#34;fnref8&#34;&gt;&lt;sup&gt;8&lt;/sup&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;wouldnt-it-be-nice&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Wouldn‚Äôt it be nice‚Ä¶&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;‚Ä¶ to polish that plot even more? For starters, the colour code is not ideal‚Ä¶&lt;/li&gt;
&lt;li&gt;‚Ä¶ to add information about the correlation between SNPs, like in &lt;a href=&#34;http://locuszoom.org/&#34;&gt;LocusZoom plots&lt;/a&gt;?&lt;/li&gt;
&lt;li&gt;‚Ä¶ or have an interactive plot&lt;a href=&#34;#fn9&#34; class=&#34;footnoteRef&#34; id=&#34;fnref9&#34;&gt;&lt;sup&gt;9&lt;/sup&gt;&lt;/a&gt;: hovering over the SNP points would light up the corresponding genes or give some other information, like the allele frequency.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Totally üòâ Seems like great material for future blogposts!&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;source&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Source&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;The R Markdown file is &lt;a href=&#34;https://github.com/sinarueeger/webpage/blob/master/blogdown/content/post/2018-07-04-plotting-local-genomic-association-results-in-r.Rmd&#34;&gt;here&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Some more &lt;code&gt;biomaRt&lt;/code&gt; code snippets are in a &lt;a href=&#34;https://gist.github.com/sinarueeger/4430492e67639fccaeacf4340f7cb7df&#34;&gt;gist&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If you know another R-package to solve a similar problem or have feedback, you can comment below üëá.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;footnotes&#34;&gt;
&lt;hr /&gt;
&lt;ol&gt;
&lt;li id=&#34;fn1&#34;&gt;&lt;p&gt;Thanks to &lt;a href=&#34;https://twitter.com/ma_salmon&#34;&gt;Ma√´lle Salmon&lt;/a&gt; you get a real plot here instead of a blurry hand drawing üòâ She gave lots of feedback on my first version - much appreciated!&lt;a href=&#34;#fnref1&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn2&#34;&gt;&lt;p&gt;Awesome icons in R? &lt;i class=&#34;ion  ion-camera &#34;&gt;&lt;/i&gt; &lt;i class=&#34;ion  ion-thumbsup &#34;&gt;&lt;/i&gt; &lt;i class=&#34;ion  ion-social-apple &#34;&gt;&lt;/i&gt; &lt;i class=&#34;ion  ion-paperclip &#34;&gt;&lt;/i&gt; &lt;i class=&#34;ion  ion-arrow-right-a &#34;&gt;&lt;/i&gt; checkout &lt;a href=&#34;https://ropensci.org/technotes/2018/05/15/icon/&#34;&gt;these instructions by Mitchell O‚ÄôHara-Wild on the rOpenSci webpage&lt;/a&gt;.&lt;a href=&#34;#fnref2&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn3&#34;&gt;&lt;p&gt;Thanks to my colleagues with biology background for explaining me the differences between these databases and what a biomart is!&lt;a href=&#34;#fnref3&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn4&#34;&gt;&lt;p&gt;Initially, I wanted to use data from two recent studies by the &lt;a href=&#34;https://www.med.unc.edu/pgc/&#34;&gt;Psychiatric Genomics Consortium&lt;/a&gt; (PGC) on &lt;a href=&#34;https://www.sciencedirect.com/science/article/pii/S0092867418306585?via%3Dihub&#34;&gt;schizophrenia (SCZ) and bipoloar disorder (BD)&lt;/a&gt;, as well as &lt;a href=&#34;https://www.nature.com/articles/s41588-018-0090-3&#34;&gt;Major depressive disorder (MDD)&lt;/a&gt;. Like most consortia, PGC provides summary statistics that can be &lt;a href=&#34;https://www.med.unc.edu/pgc/results-and-downloads/downloads&#34;&gt;downloaded&lt;/a&gt;. However, before downloading anything, the user needs to acknowledge and agree to a list of conditions - which I think is an excellent approach! - therefore we cannot directly load it into R.&lt;a href=&#34;#fnref4&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn5&#34;&gt;&lt;p&gt;Data source: &lt;a href=&#34;https://www.biorxiv.org/content/early/2018/03/22/274654&#34;&gt;Yengo et al. (2018)&lt;/a&gt;.&lt;a href=&#34;#fnref5&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn6&#34;&gt;&lt;p&gt;A guide to crafting Manhattan plots by &lt;a href=&#34;https://github.com/holtzy/&#34;&gt;Yan Holtz&lt;/a&gt; for the &lt;a href=&#34;https://www.r-graph-gallery.com/wp-content/uploads/2018/02/Manhattan_plot_in_R.html&#34;&gt;R graph gallery&lt;/a&gt;&lt;a href=&#34;#fnref6&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn7&#34;&gt;&lt;p&gt;I recently listened to a podcast by &lt;a href=&#34;https://twitter.com/trashystats&#34;&gt;Saskia Freytag&lt;/a&gt; and &lt;a href=&#34;https://twitter.com/nj_tierney&#34;&gt;NJ Tierney&lt;/a&gt; where they talk about the differences between CRAN and Bioconductor (there are many!). The podcast is called &lt;a href=&#34;https://soundcloud.com/crediblycurious/episode-1-cran-and-bioconductor&#34;&gt;Credibly Curious&lt;/a&gt;.&lt;a href=&#34;#fnref7&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn8&#34;&gt;&lt;p&gt;+1 for reproducibility!&lt;a href=&#34;#fnref8&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li id=&#34;fn9&#34;&gt;&lt;p&gt;&lt;a href=&#34;https://twitter.com/LizaMGD&#34;&gt;Liza Darrous&lt;/a&gt; pointed out the interactive Manhattan R function &lt;a href=&#34;https://moderndata.plot.ly/manhattanly-r-package-for-interactive-manhattan-plots/&#34;&gt;manhanttanly&lt;/a&gt;.&lt;a href=&#34;#fnref9&#34;&gt;‚Ü©&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Setting up the Blogdown website</title>
      <link>/2018/04/14/setting-up-the-blogdown-website/</link>
      <pubDate>Sat, 14 Apr 2018 10:00:03 +0200</pubDate>
      
      <guid>/2018/04/14/setting-up-the-blogdown-website/</guid>
      <description>

&lt;p&gt;To set up this website I have used some excellent material around &lt;a href=&#34;https://bookdown.org/yihui/blogdown/get-started.html&#34;&gt;&lt;strong&gt;blogdown&lt;/strong&gt;&lt;/a&gt;, &lt;a href=&#34;https://pages.github.com/&#34;&gt;&lt;strong&gt;github&lt;/strong&gt;&lt;/a&gt; and &lt;a href=&#34;https://themes.gohugo.io/&#34;&gt;&lt;strong&gt;hugo&lt;/strong&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;motivation&#34;&gt;Motivation&lt;/h2&gt;

&lt;p&gt;Before going into the technical details, let me say something about motivation and inspiration. For me, it definitely helped to read the blogpost by &lt;a href=&#34;http://varianceexplained.org/r/start-blog/&#34;&gt;David Robinson&lt;/a&gt;, being encouraged by &lt;a href=&#34;http://www.masalmon.eu/rladiesct/slides#1&#34;&gt;Ma&amp;euml;lle Salmon&lt;/a&gt; and seeing many others leading by example (among many: &lt;a href=&#34;http://mcdussault.rbind.io/post/building-your-blog-using-blogdown/&#34;&gt;Marie Christine Dussault&lt;/a&gt; or &lt;a href=&#34;https://kkulma.github.io/2017-12-29-end-of-year-thoughts/&#34;&gt;Kasia Kulma&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;I might get into a more personal motivation in a future blogpost.&lt;/p&gt;

&lt;h2 id=&#34;instructions-to-get-a-first-version-running&#34;&gt;Instructions to get a first version running&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;blogdown&lt;/strong&gt; &lt;em&gt;package&lt;/em&gt; &amp;amp; &lt;em&gt;instructions&lt;/em&gt; by &lt;a href=&#34;https://bookdown.org/yihui/blogdown/get-started.html&#34;&gt;Yihui Xie, Amber Thomas and Alison Presmanes Hill&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://www.emilyzabor.com/tutorials/rmarkdown_websites_tutorial.html&#34;&gt;Emily Zabor&lt;/a&gt; gives a general &lt;strong&gt;overview&lt;/strong&gt; of how to make websites, not limited to blogging. But from her tutorial I learned about the &lt;code&gt;serve site&lt;/code&gt; feature.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Instructions by &lt;a href=&#34;http://mcdussault.rbind.io/post/building-your-blog-using-blogdown/&#34;&gt;Marie Christine Dussault&lt;/a&gt; include the nitty-gritty details of &lt;strong&gt;changing the domain name&lt;/strong&gt; when deploying to &lt;a href=&#34;https://www.netlify.com/&#34;&gt;Netlify&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;changing-the-layout&#34;&gt;Changing the layout&lt;/h2&gt;

&lt;h3 id=&#34;1-choose-a-theme&#34;&gt;1. Choose a theme&lt;/h3&gt;

&lt;p&gt;Ideally, you should choose a theme &lt;strong&gt;before&lt;/strong&gt; you create your website with blogdown.&lt;/p&gt;

&lt;p&gt;I did not, but my page had not much content yet. I had the &lt;em&gt;academic&lt;/em&gt; theme first, then changed to &lt;em&gt;ghostwriter&lt;/em&gt;, because I like simplicity and wanted the blog posts to have their own page.&lt;/p&gt;

&lt;p&gt;Hugo has a &lt;a href=&#34;https://themes.gohugo.io/&#34;&gt;gallery&lt;/a&gt; with different themes. Choose one (be aware that not all themes were &lt;a href=&#34;https://bookdown.org/yihui/blogdown/other-themes.html&#34;&gt;tested against&lt;/a&gt; blogdown!).&lt;/p&gt;

&lt;p&gt;While the &lt;em&gt;academic&lt;/em&gt; theme offers different color palettes in the &lt;code&gt;.toml&lt;/code&gt; file, the &lt;strong&gt;ghostwriter&lt;/strong&gt; does not have this feature.&lt;/p&gt;

&lt;h3 id=&#34;2-personalising-the-css-file&#34;&gt;2. Personalising the &lt;code&gt;.css&lt;/code&gt; file&lt;/h3&gt;

&lt;p&gt;Luckily, you can access the &lt;code&gt;.css&lt;/code&gt; file and change everything you want (depending on how experienced you are with css files).&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;.css&lt;/code&gt; file is located in &lt;code&gt;/themes/ghostwriter/static/dist/style.css&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I wanted to personalise two things:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;color&lt;/li&gt;
&lt;li&gt;font&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;color&#34;&gt;Color&lt;/h4&gt;

&lt;p&gt;The default color theme is red. But I wanted something dark blue. So I went through all the colors (look for &lt;code&gt;#&lt;/code&gt;) and changed all red to &lt;code&gt;#003366&lt;/code&gt; and all light red to &lt;code&gt;#deebf7&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&#34;font&#34;&gt;Font&lt;/h4&gt;

&lt;p&gt;The default font is &lt;a href=&#34;https://fonts.google.com/specimen/Open+Sans&#34;&gt;&lt;font face=&#34;Open Sans&#34;&gt;Open Sans&lt;/font&gt;&lt;/a&gt;. But you can add other fonts too. &lt;del&gt;I went for Futura &lt;a href=&#34;https://fonts.google.com/specimen/Dosis&#34;&gt;Dosis&lt;/a&gt;, simply, because I prefer it (currently).&lt;/del&gt;&lt;/p&gt;

&lt;h3 id=&#34;3-caution&#34;&gt;3. Caution!&lt;/h3&gt;

&lt;p&gt;When choosing a theme and changing the &lt;code&gt;css&lt;/code&gt; file keep the last paragraph from this &lt;a href=&#34;https://bookdown.org/yihui/blogdown/other-themes.html&#34;&gt;section&lt;/a&gt; from the blogdown instructions in mind!&lt;/p&gt;

&lt;h2 id=&#34;incorporating-gist-files&#34;&gt;Incorporating &lt;em&gt;gist&lt;/em&gt; files&lt;/h2&gt;

&lt;p&gt;My first post was written on &lt;a href=&#34;https://gist.github.com/&#34;&gt;gist.github&lt;/a&gt; first. To embed &lt;em&gt;gist&lt;/em&gt; posts, I used the workaround documented &lt;a href=&#34;https://gohugo.io/content-management/shortcodes/#gist&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The following code snippet will only display the file &lt;code&gt;encryption_files.md&lt;/code&gt; from the &lt;em&gt;gist&lt;/em&gt; &lt;code&gt;https://gist.github.com/sinarueeger/aadfe4916cf285e32d5a55f320a82a6f&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-md&#34; data-lang=&#34;md&#34;&gt;{{&amp;lt; gist sinarueeger aadfe4916cf285e32d5a55f320a82a6f &amp;#34;encryption_files.md&amp;#34; &amp;gt;}}
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Getting started with encryption of documents</title>
      <link>/2018/04/13/getting-started-with-encryption-of-documents/</link>
      <pubDate>Fri, 13 Apr 2018 20:40:59 +0200</pubDate>
      
      <guid>/2018/04/13/getting-started-with-encryption-of-documents/</guid>
      <description>&lt;p&gt;I work (broadly speaking) in epidemiology. Within collaborations we often have to share &lt;strong&gt;sensitive data&lt;/strong&gt; across institutions and are therefore likely to not share IT facilities. But the most often used options - bare e-mail or file hosting - are not secure, as they both work via a server that could potentially be exposed.&lt;/p&gt;

&lt;p&gt;There are a handful of secure options around (&lt;a href=&#34;https://protonmail.com/&#34;&gt;ProtonMail&lt;/a&gt; or &lt;a href=&#34;https://keybase.io/&#34;&gt;keybase.io&lt;/a&gt;, both working via &lt;a href=&#34;https://www.quora.com/Why-is-encryption-important&#34;&gt;encryption&lt;/a&gt;), but for those that &lt;strong&gt;trust open source projects&lt;/strong&gt; the most and are familiar with a &lt;strong&gt;terminal&lt;/strong&gt; I have written some basic instructions for asymmetric GPG encryption.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;I should say that I am not an encryption expert at all. But, although there is a lot of talk about data protection, I never came across a compact, easy-to-follow instruction for the sender of the document and the recipient, valid for all three operating systems (Linux, Mac, Windows). Therefore, I tried to write one, mainly for myself and collaborators. Feedback is appreciated!&lt;/em&gt;&lt;/p&gt;

&lt;script src=&#34;//gist.github.com/sinarueeger/aadfe4916cf285e32d5a55f320a82a6f.js?file=encryption_files.md&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>Contact</title>
      <link>/page/contact/</link>
      <pubDate>Fri, 13 Apr 2018 02:13:50 +0000</pubDate>
      
      <guid>/page/contact/</guid>
      <description>

&lt;h2 id=&#34;contact&#34;&gt;Contact&lt;/h2&gt;

&lt;p&gt;E-mail: &lt;a href=&#34;mailto:sina.rueeger@gmail.com&#34;&gt;sina.rueeger@gmail.com&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Or via &lt;a href=&#34;https://keybase.io/sinarueeger/&#34;&gt;@sinarueeger&lt;/a&gt; on &lt;a href=&#34;https://keybase.io/&#34;&gt;Keybase&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>About</title>
      <link>/page/about/</link>
      <pubDate>Thu, 13 Apr 2017 02:13:50 +0000</pubDate>
      
      <guid>/page/about/</guid>
      <description>

&lt;p&gt;&lt;img src=&#34;/img/portrait.jpg&#34; alt=&#34;This is me.&#34; align=&#34;middle&#34; style=&#34;width: 200px;&#34;/&gt;&lt;/p&gt;

&lt;h2 id=&#34;my-journey&#34;&gt;My journey&lt;/h2&gt;

&lt;p align=&#34;justify&#34;&gt;I studied Data Analysis &amp; Process Design at the School of Engineering in Winterthur, where I fell in love with applied statistics. I deepened my knowledge in statistical modelling with a Master&#39;s degree and by working as a research assistant. During my time as a biostatistician I enjoyed the interdisciplinary aspect and grew an interest in analysing genetic data - which ultimately lead me to my current position to Lausanne.&lt;/p&gt;

&lt;p align=&#34;justify&#34;&gt;Since 2013, I am a PhD student in &lt;b&gt;Statistical Genetics&lt;/b&gt; under the supervision of &lt;a href=&#34;https://wp.unil.ch/sgg/&#34;&gt;Zolt&amp;#225;n Kutalik&lt;/a&gt; at the Institute of Social and Preventive Medicine at the Lausanne University Hospital in Switzerland. The focus of my PhD is the analysis of GWAS, -omics and epidemiological data.&lt;/p&gt;

&lt;h2 id=&#34;interests&#34;&gt;Interests&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Data analysis and statistical modelling paired with R&lt;/li&gt;
&lt;li&gt;Visual representation of concepts and results&lt;/li&gt;
&lt;li&gt;Interplay between health, medicine and technology&lt;/li&gt;
&lt;li&gt;Reproducibility and open science&lt;/li&gt;
&lt;/ul&gt;

&lt;p align=&#34;justify&#34;&gt;I am glad that I encountered &lt;a href=&#34;https://en.wikipedia.org/wiki/R_(programming_language)&#34;&gt;R&lt;/a&gt; early in my studies and I like how it has evolved over time. As an open source project, lots of people are making contributions and so there is always something to learn. I like to share my passion for R, and together with three colleagues I am organising &lt;a href=&#34;https://www.meetup.com/rladies-lausanne/&#34;&gt;R-Ladies Lausanne&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;resume&#34;&gt;Resume&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;/files/resume_sinarueeger.pdf&#34;&gt;RESUME (PDF)&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;publication-list&#34;&gt;Publication list&lt;/h2&gt;

&lt;p&gt;&amp;rightarrow; &lt;a href=&#34;https://scholar.google.com/citations?view_op=list_works&amp;amp;hl=de&amp;amp;authuser=1&amp;amp;user=OD9gCh4AAAAJ&#34;&gt;scholar.google.com&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;other-than-that&#34;&gt;Other than that&amp;hellip;&lt;/h2&gt;

&lt;p&gt;I am a keen cyclist and blog about bikepacking &lt;a href=&#34;https://medium.com/@sinarueeger/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>