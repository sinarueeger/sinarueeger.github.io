<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Compute LD on site &middot; Sina RÃ¼eger</title>
        <meta name="description" content="LD Part 2">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.38.2" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link rel="stylesheet" href="/dist/styles.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Anaheim|Assistant|Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        
        
    </head>
    <body>
        

        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="Analysing genetic data" href="/">Analysing genetic data</a>
                            </h1>
                        
                        <a class="button-square" href="/index.xml"><i class="fa fa-rss"></i></a>
                        
                            <a class="button-square button-social hint--top" data-hint="Twitter" title="Twitter" href="https://twitter.com/sinarueeger">
                                <i class="fa fa-twitter"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/sinarueeger">
                                <i class="fa fa-github"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="LinkedIn" title="LinkedIn" href="https://www.linkedin.com/in/sinarueeger/">
                                <i class="fa fa-linkedin"></i>
                            </a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Google Scholar" title="Google Scholar" href="https://scholar.google.com/citations?view_op=list_works&amp;hl=de&amp;authuser=1&amp;user=OD9gCh4AAAAJ">
                                <i class="fa fa-book"></i>
                            </a>
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Email" title="Email" href="mailto:sina.rueeger@gmail.com">
                                <i class="fa fa-envelope"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a title="Blog" href="/post/">Blog</a>
    </li>

    <li class="site-nav-item">
        <a title="Resources" href="/page/resources/">Resources</a>
    </li>

    <li class="site-nav-item">
        <a title="About" href="/page/about/">About</a>
    </li>

    <li class="site-nav-item">
        <a title="Contact" href="/page/contact/">Contact</a>
    </li>

                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Compute LD on site</h1>
    
        <p class="post-description" itemprop="description">LD Part 2</p>
    
    <p class="post-date">
        <span>Published <time datetime="2018-09-06" itemprop="datePublished">Thu, Sep 6, 2018</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="https://twitter.com/sinarueeger" itemprop="url" rel="author">Sina RÃ¼eger</a>
            </span>
        </span>
    </p>
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    

    <p>I have this foggy memory that I once loaded one xx MB into R, on a server, worse, on the master, and then I applied the correlation function not accounting for the NAs. But I might have been dreaming this though - one of my biggest nightmares is to kill an HPC.</p>

<p>After all, R is a software for statistical computing, so why not calculating the correlation - THE statistics - in R?
  For starters, it requires to have the data somewhere stored. For 1000 genomes reference panel you need xxx MB.
Second, R &ldquo;handles large datasets badly&rdquo;. I put that in quotes, because I have no idea how to say that otherwise and I also have no idea why. It just seems super inefficient. If you need to import a large file, think twice, or tweak it. For example, for correlations this would mean, only importing a range of columns. But reference panels typically come in vcf format, so good luck with that.
Lastly, try to calculate a 1000 by 1000 correlation matrix in R. Uses loads of memory! Even if you do &hellip;</p>

<p>There are a couple of options out there:
  1. have 1000 genomes stored somewhere, use some special tool like <a href="https://github.com/statgen/emeraLD/blob/master/emeraLD2R.r">emeraLD</a> (input vcf files), <a href="https://www.cog-genomics.org/plink/1.9/ld">plink</a> or <a href="http://www.christianbenner.com/#ldstore">LDSTORE</a> (input bgen or binary plink), all requiring computing space and &hellip;
                                                                                                                                                                                                                               2. precompute matrices, store and access them (requires HPC)
                                                                                                                                                                                                                             3. use an API that does all this for you.</p>

<pre><code>                                                                                                                                                                                                                         For example: the [locuszoom](https://genome.sph.umich.edu/wiki/LocusZoom_Standalone#Download) standalone function comes with all reference panels needed to calculate LD. This has advantages (always up to date, reproducible, independent) and disadvantages (BIG! MB)


                                                                                                                                                                                                                                                      - [**emeraLD**](https://github.com/statgen/emeraLD)
                                                                                                                                                                                                                                                      - ðŸ”º LD
                                                                                                                                                                                                                                                      - Input file formats: VCF

                                                                                                                                                                                                                                                      - -[QCTOOL](http://www.well.ox.ac.uk/~gav/qctool_v2/))
                                                                                                                                                                                                                         ðŸ”º LD
                                                                                                                                                                                                                         - Input file formats: bgen, binary plink (no vcf, meaning, reference panels in vcf format have to be transformed first into a bgen file with [Q## Reference panels
</code></pre>

<p>calc LD genetics::LD</p>

<p>download
<a href="https://www.cog-genomics.org/plink/1.9/ld">https://www.cog-genomics.org/plink/1.9/ld</a></p>

</div>

        <footer class="post-footer clearfix">
    
        <p class="post-tags">
            <span>Tagged:</span>
            
            
                <a href="/tags/statgen/">statgen</a>, 
            
                <a href="/tags/r/">R</a>, 
            
                <a href="/tags/data-visualisation/">data visualisation</a>, 
            
                <a href="/tags/r/">R</a>, 
            
                <a href="/tags/ggplot2/">ggplot2</a>
            
        </p>
    

    <div class="share">
        

        

        
        
    </div>
</footer>

        
    <div class="comments">
        <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "sinarueeger-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>

    </article>
</div>

    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    });
    </script>
    <script type="text/javascript"
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>

    <footer class="footer">
      <div class="container">
        <p class="footer-copyright">
                    <span>&copy; 2018. All rights reserved.</span>
        </p>
      </div>
    </footer>
    
  </body>
</html>

